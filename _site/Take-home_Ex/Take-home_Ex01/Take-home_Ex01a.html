<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-02-13">

<title>IS415 - GAA - Take-home Exercise 1a [DATA PREPARATION]: Application of Spatial Point Patterns Analysis to Discover the Geographical Distribution of Grab Hailing Services in Singapore</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415 - GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex3.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03-NKDE.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01a.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1a: Data Preparation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01b.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1b: Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02a.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2a: Data Preparation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02b.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2b: Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About Me!</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1 Overview</a></li>
  <li><a href="#setting-the-scene" id="toc-setting-the-scene" class="nav-link" data-scroll-target="#setting-the-scene">1.1 Setting the scene</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.2 Objectives</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">2 Getting Started</a></li>
  <li><a href="#data-acquisition" id="toc-data-acquisition" class="nav-link" data-scroll-target="#data-acquisition">2.1 Data Acquisition</a></li>
  <li><a href="#importing-relevant-r-packages" id="toc-importing-relevant-r-packages" class="nav-link" data-scroll-target="#importing-relevant-r-packages"><strong>2.2 Importing Relevant R Packages</strong></a></li>
  <li><a href="#importing-geospatial-datasets" id="toc-importing-geospatial-datasets" class="nav-link" data-scroll-target="#importing-geospatial-datasets">2.3 Importing Geospatial Datasets</a>
  <ul class="collapse">
  <li><a href="#master-plan-2019-subzone-boundary-no-sea" id="toc-master-plan-2019-subzone-boundary-no-sea" class="nav-link" data-scroll-target="#master-plan-2019-subzone-boundary-no-sea">2.3.1 Master Plan 2019 Subzone Boundary (No Sea)</a></li>
  <li><a href="#coastal-outline" id="toc-coastal-outline" class="nav-link" data-scroll-target="#coastal-outline">2.3.2 Coastal Outline</a></li>
  <li><a href="#extracting-outer-islands" id="toc-extracting-outer-islands" class="nav-link" data-scroll-target="#extracting-outer-islands">2.3.2.1 Extracting Outer Islands</a></li>
  <li><a href="#rendering-a-coastal-boundary-excluding-outer-islands" id="toc-rendering-a-coastal-boundary-excluding-outer-islands" class="nav-link" data-scroll-target="#rendering-a-coastal-boundary-excluding-outer-islands">2.3.2.2 Rendering a Coastal Boundary Excluding Outer Islands</a></li>
  <li><a href="#open-street-map-road-data" id="toc-open-street-map-road-data" class="nav-link" data-scroll-target="#open-street-map-road-data">2.3.3 Open Street Map Road Data</a></li>
  </ul></li>
  <li><a href="#importing-aspatial-datasets" id="toc-importing-aspatial-datasets" class="nav-link" data-scroll-target="#importing-aspatial-datasets">2.4 Importing Aspatial Datasets</a>
  <ul class="collapse">
  <li><a href="#grab-posisi" id="toc-grab-posisi" class="nav-link" data-scroll-target="#grab-posisi">2.4.1 Grab-Posisi</a></li>
  <li><a href="#converting-aspatial-data-frame-into-a-simple-feature-data-frame" id="toc-converting-aspatial-data-frame-into-a-simple-feature-data-frame" class="nav-link" data-scroll-target="#converting-aspatial-data-frame-into-a-simple-feature-data-frame">2.4.1.2 Converting Aspatial Data Frame into a Simple Feature Data Frame</a></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">2.5 Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#extracting-grab-trips-starting-locations" id="toc-extracting-grab-trips-starting-locations" class="nav-link" data-scroll-target="#extracting-grab-trips-starting-locations">2.5.1 <strong>Extracting Grab Trips Starting Locations</strong></a></li>
  <li><a href="#extracting-grab-trips-ending-locations" id="toc-extracting-grab-trips-ending-locations" class="nav-link" data-scroll-target="#extracting-grab-trips-ending-locations">2.5.2 <strong>Extracting Grab Trips Ending Locations</strong></a></li>
  <li><a href="#converting-simple-features-to-planar-point-pattern-objects" id="toc-converting-simple-features-to-planar-point-pattern-objects" class="nav-link" data-scroll-target="#converting-simple-features-to-planar-point-pattern-objects">2.5.3 Converting Simple Features to Planar Point Pattern Objects</a></li>
  <li><a href="#check-for-duplicates-and-handle-data-errors" id="toc-check-for-duplicates-and-handle-data-errors" class="nav-link" data-scroll-target="#check-for-duplicates-and-handle-data-errors">2.5.4 Check for Duplicates and Handle Data Errors</a></li>
  <li><a href="#introducing-owin" id="toc-introducing-owin" class="nav-link" data-scroll-target="#introducing-owin">2.5.5 Introducing OWIN</a></li>
  <li><a href="#creating-owin-object" id="toc-creating-owin-object" class="nav-link" data-scroll-target="#creating-owin-object">2.5.5.1 Creating OWIN Object</a></li>
  <li><a href="#combining-point-events-and-owin-object" id="toc-combining-point-events-and-owin-object" class="nav-link" data-scroll-target="#combining-point-events-and-owin-object">2.5.5.2 Combining Point Events and OWIN Object</a></li>
  <li><a href="#origin-points-in-owin-object" id="toc-origin-points-in-owin-object" class="nav-link" data-scroll-target="#origin-points-in-owin-object">2.5.5.2.1 Origin Points in OWIN Object</a></li>
  <li><a href="#destination-points-in-owin-object" id="toc-destination-points-in-owin-object" class="nav-link" data-scroll-target="#destination-points-in-owin-object">2.5.5.2.1 Destination Points in OWIN Object</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">3.0 Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#spatial-relationship-between-origin-and-destination-points" id="toc-spatial-relationship-between-origin-and-destination-points" class="nav-link" data-scroll-target="#spatial-relationship-between-origin-and-destination-points">3.1 Spatial Relationship between Origin and Destination Points</a></li>
  <li><a href="#spatio-temporal-visualisations" id="toc-spatio-temporal-visualisations" class="nav-link" data-scroll-target="#spatio-temporal-visualisations">3.2 Spatio-Temporal Visualisations</a></li>
  <li><a href="#frequency-of-trip-by-hour" id="toc-frequency-of-trip-by-hour" class="nav-link" data-scroll-target="#frequency-of-trip-by-hour">3.2.1 Frequency of Trip by Hour</a></li>
  <li><a href="#origin-or-pickup-frequency" id="toc-origin-or-pickup-frequency" class="nav-link" data-scroll-target="#origin-or-pickup-frequency">3.2.1.1 Origin or Pickup Frequency</a></li>
  <li><a href="#destination-or-drop-off-frequency" id="toc-destination-or-drop-off-frequency" class="nav-link" data-scroll-target="#destination-or-drop-off-frequency">3.2.1.2 Destination or Drop-off Frequency</a></li>
  <li><a href="#frequency-of-trip-by-day-of-week" id="toc-frequency-of-trip-by-day-of-week" class="nav-link" data-scroll-target="#frequency-of-trip-by-day-of-week">3.2.2 Frequency of Trip by Day of Week</a></li>
  <li><a href="#origin-or-pickup-frequency-by-days" id="toc-origin-or-pickup-frequency-by-days" class="nav-link" data-scroll-target="#origin-or-pickup-frequency-by-days">3.2.2.1 Origin or Pickup Frequency by Days</a></li>
  <li><a href="#destination-or-drop-off-frequency-by-days" id="toc-destination-or-drop-off-frequency-by-days" class="nav-link" data-scroll-target="#destination-or-drop-off-frequency-by-days">3.2.2.2 Destination or Drop-off Frequency by Days</a></li>
  </ul></li>
  <li><a href="#first-order-spatial-point-patterns-analysis" id="toc-first-order-spatial-point-patterns-analysis" class="nav-link" data-scroll-target="#first-order-spatial-point-patterns-analysis"><strong>4.0 First-Order Spatial Point Patterns Analysis</strong></a>
  <ul class="collapse">
  <li><a href="#rescale-grab_original_ppp_sg-and-grab_dest_ppp_sg" id="toc-rescale-grab_original_ppp_sg-and-grab_dest_ppp_sg" class="nav-link" data-scroll-target="#rescale-grab_original_ppp_sg-and-grab_dest_ppp_sg"><strong>4.1</strong> Rescale <code>grab_original_ppp_sg</code> and <code>grab_dest_ppp_sg</code></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 1a [DATA PREPARATION]: Application of Spatial Point Patterns Analysis to Discover the Geographical Distribution of Grab Hailing Services in Singapore</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 13, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">1 Overview</h2>
</section>
<section id="setting-the-scene" class="level2">
<h2 class="anchored" data-anchor-id="setting-the-scene">1.1 Setting the scene</h2>
<p>Understanding how people move around in a city is like figuring out its heartbeat—it shows us the rhythms that shape our urban lives. Thanks to smartphones and technology, we now have a bunch of data about how people move. When we use smart analysis tools like GIS, we can unlock valuable insights that help us plan cities better.</p>
<p>In 2020, GRAB shared a set of data called Grab Posisi, all about how people move around in Singapore. This kind of information isn’t just interesting; it’s super helpful for businesses, people who make decisions about the city, and those who plan how cities work. It’s like having a dynamic picture of how people move, helping us create cities that work well for everyone.</p>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">1.2 Objectives</h2>
<p>The objectives of this take-home exercise are to:</p>
<ul>
<li><p>Apply geospatial analytics to address societal challenges</p></li>
<li><p>Use spatial point patterns analysis methods to explore Grab hailing services distribution in Singapore</p></li>
<li><p>Organise geospatial data into sf tibble data.frames using <code>sf</code> and <code>tidyverse</code> functions</p></li>
<li><p>Focus on Grab taxi location points, road layer within Singapore, and Singapore coastal boundary layer</p></li>
<li><p>Generate traditional Kernel Density Estimation layers</p></li>
<li><p>Create Network Kernel Density Estimation (NKDE)</p></li>
<li><p>Utilise <code>tmap</code> functions to display kernel density layers on OSM</p></li>
<li><p>Describe spatial patterns revealed by the kernel density maps</p></li>
</ul>
<p>By this exercise, I will:</p>
<ul>
<li><p>Enhance my understanding of geospatial analytics applications</p></li>
<li><p>Develop proficiency in spatial point patterns analysis</p></li>
<li><p>Gain hands-on experience in dealing with geospatial data</p></li>
<li><p>Explore Grab hailing services distribution patterns in Singapore</p></li>
<li><p>Generate and interpret Kernel Density Estimation layers</p></li>
<li><p>Understand the nuances of Network Kernel Density Estimation (NKDE)</p></li>
<li><p>Learn about the visualisation of spatial patterns using <code>tmap</code> functions on OSM</p></li>
</ul>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">2 Getting Started</h2>
</section>
<section id="data-acquisition" class="level2">
<h2 class="anchored" data-anchor-id="data-acquisition">2.1 Data Acquisition</h2>
<p>The study will utilise the following datasets to explore spatial point patterns analysis methods and reveal the geographical and spatio-temporal distribution of Grab hailing services locations in Singapore.</p>
<table class="table">
<thead>
<tr class="header">
<th>Dataset Name</th>
<th>Type</th>
<th>Source</th>
<th>Path</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Grab-Posisi</td>
<td>Aspatial (.parquet)</td>
<td><a href="https://engineering.grab.com/grab-posisi" class="uri">https://engineering.grab.com/grab-posisi</a></td>
<td>data/aspatial/grabPosisi</td>
</tr>
<tr class="even">
<td>Master Plan 2019 Subzone Boundary (No Sea)</td>
<td>Geospatial (.shp)</td>
<td><a href="https://beta.data.gov.sg/collections/2104/view" class="uri">https://beta.data.gov.sg/collections/2104/view</a></td>
<td>data/geospatial/MPSZ-2019</td>
</tr>
<tr class="odd">
<td>Open Street Map Road Data</td>
<td>Geospatial (.shp)</td>
<td><a href="https://download.geofabrik.de/asia/malaysia-singapore-brunei.html" class="uri">https://download.geofabrik.de/asia/malaysia-singapore-brunei.html</a></td>
<td>data/geospatial/OSM/gis_osm_roads_free_1</td>
</tr>
</tbody>
</table>
</section>
<section id="importing-relevant-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="importing-relevant-r-packages"><strong>2.2 Importing Relevant R Packages</strong></h2>
<p>The R packages used in this project are:</p>
<ol type="1">
<li><p><code>arrow</code>: for reading and writing Parquet files</p></li>
<li><p><code>dplyr</code>: for data manipulation</p></li>
<li><p><code>lubridate</code>: for working with date-time data</p></li>
<li><p><code>maptools</code>: set of tools for reading and manipulating spatial data formats, such as shapefiles</p></li>
<li><p><code>raster</code>: reads, writes, manipulates, analyses, and models gridded spatial data</p></li>
<li><p><code>rgdal</code>: from CRAN, enables users to import, export, and manipulate spatial data within the R environment</p></li>
<li><p><code>RcolorBrewer</code>: package providing color schemes for maps and other visualizations</p></li>
<li><p><code>rmapshaper</code>: a package for simplifying and modifying geographic shapes in R</p></li>
<li><p><code>sf</code>: for importing, managing, and processing geospatial data</p></li>
<li><p><code>spNetwork</code>: to perform spatial analysis for NKDE</p></li>
<li><p><code>spatstat</code>: for performing spatial point patterns analysis</p></li>
<li><p><code>tidyverse</code>: a family of other R packages for performing data science tasks such as importing, wrangling, and visualizing data</p></li>
<li><p><code>tmap</code>: creating static and interactive maps</p></li>
<li><p><code>ggplot2</code>: used for data visualization</p></li>
<li><p><code>plotly</code>: interactive graphing library for R</p></li>
</ol>
<p>Pacman assists us by helping us load R packages that we require.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a> pacman<span class="sc">::</span><span class="fu">p_load</span>(arrow, dplyr, lubridate, maptools, raster, rgdal, RColorBrewer, rmapshaper, sf, sp, spNetwork, spatstat, tidyverse, tmap, ggplot2, plotly)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#update.packages(ask = FALSE, dependencies = TRUE)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages("maptools", repos = "https://packagemanager.posit.co/cran/2023-10-13")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-geospatial-datasets" class="level2">
<h2 class="anchored" data-anchor-id="importing-geospatial-datasets">2.3 Importing Geospatial Datasets</h2>
<section id="master-plan-2019-subzone-boundary-no-sea" class="level3">
<h3 class="anchored" data-anchor-id="master-plan-2019-subzone-boundary-no-sea">2.3.1 Master Plan 2019 Subzone Boundary (No Sea)</h3>
<p>For shapefile format, two arguments are required:&nbsp;<code>dsn</code>&nbsp;to define the data path, and&nbsp;<code>layer</code>&nbsp;to provide the shapefile name.&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mpsz_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"MPSZ-2019"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Project Transformation</strong></p>
<p>Given that our dataset corresponds to the geographical boundaries of Singapore, it is necessary to specify the appropriate CRS for accurate spatial analysis. To achieve this, the <strong><code>st_transform()</code></strong> function is used to convert the CRS of <code>mpsz_sf</code> to SVY21 (EPSG: 3414)</p>
</div>
</div>
</section>
<section id="coastal-outline" class="level3">
<h3 class="anchored" data-anchor-id="coastal-outline">2.3.2 Coastal Outline</h3>
<p>In order to create a costal outline of singapore, we will use the <code>st_union</code> function to consolidate all subzone boundaries from <code>mpsz_sf</code> into a single polygon.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>outline <span class="ot">=</span> mpsz_sf <span class="sc">%&gt;%</span> <span class="fu">st_union</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(outline)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extracting-outer-islands" class="level3">
<h3 class="anchored" data-anchor-id="extracting-outer-islands">2.3.2.1 Extracting Outer Islands</h3>
<p>As seen in the figure above, the coastal outline includes outer islands where Grab service is unavailable. Through the code chunk below, we use the <code>subset</code> function to select subzones from the <code>mpsz_sf</code> dataset to exclude. These excluded rows of data are stored in new dataframes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>semakau <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf,mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span> <span class="st">"SEMAKAU"</span>) <span class="co">#western island</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sudong <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf, mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span> <span class="st">"SUDONG"</span>) <span class="co">#western island</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>bukom <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf, mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span>  <span class="st">"JURONG ISLAND AND BUKOM"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>north <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf, mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span> <span class="st">"NORTH-EASTERN ISLANDS"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>south <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf, mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span> <span class="st">"SOUTHERN GROUP"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We combine the newly created dataframes using the <code>bind_rows</code> function and store the data in another dataframe called <code>outer</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>outer <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(<span class="fu">list</span>(semakau,sudong,bukom,north,south))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rendering-a-coastal-boundary-excluding-outer-islands" class="level3">
<h3 class="anchored" data-anchor-id="rendering-a-coastal-boundary-excluding-outer-islands">2.3.2.2 Rendering a Coastal Boundary Excluding Outer Islands</h3>
<p>We use the <code>st_union</code> function again to merge the geometries of <code>mpsz_sf</code> and <code>outer</code>, and the <code>st_difference</code> function to eliminate the overlap between the two layers. This results in a coastal boundary, <code>sg_sf</code>, which excludes the outer islands.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sg_sf <span class="ot">&lt;-</span> <span class="fu">st_difference</span>(<span class="fu">st_union</span>(mpsz_sf), <span class="fu">st_union</span>(outer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>✅ Task Complete! We have obtained the coastal boundary layer of Singapore, excluding the outer islands.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(sg_sf, "data/rds/sg_sf.rds")</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sg_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/sg_sf.rds"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sg_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll save the output in .rds file format to save loading time.</p>
</div>
</div>
</section>
<section id="open-street-map-road-data" class="level3">
<h3 class="anchored" data-anchor-id="open-street-map-road-data">2.3.3 Open Street Map Road Data</h3>
<p>Let’s import the road data obtained from OSM.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>allroads <span class="ot">=</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/OSM"</span>, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">layer =</span> <span class="st">"gis_osm_roads_free_1"</span>)  <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Project Transformation</strong></p>
<p>Given that our dataset corresponds to the geographical boundaries of Singapore, it’s necessary to specify the appropriate CRS for accurate spatial analysis. To achieve this, the <strong><code>st_transform()</code></strong> function is used to convert the CRS of <code>allroads</code> to SVY21 (EPSG: 3414)</p>
</div>
</div>
<p>This dataset encompasses road networks spanning Singapore, Malaysia, and Brunei. To narrow our focus, we will extract roads exclusively within the Singapore boundary using the <code>st_intersection</code> function to check the intersection between <code>sg_sf</code> and <code>allroads</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sg_roads_all <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(allroads,sg_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(sg_roads_all, "data/rds/sg_roads_all.rds")</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sg_roads_all <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/sg_roads_all.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll save the output in .rds file format to save loading time.</p>
</div>
</div>
<p>The next step involves examining the various road types within the road network.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(sg_roads_all<span class="sc">$</span>fclass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Given our focus on Grab services, which primarily operate on roads excluding expressways (it is not possible for Grab to pick-up or drop off passengers along expressways), we will extract the relevant road types from the road network. To determine which roads are applicable, we can look at the OSM fclass. The image below provides descriptions for each road type, and for our analysis, we will focus on the most relevant types: primary, residential, tertiary, service, secondary, primary_link, secondary_link, and tertiary_link</p>
<p><img src="images/Screenshot 2024-02-01 122342.png" class="img-fluid" width="425"></p>
<p>We store the selected road types in a dataframe called <code>sg_roads_filtered</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sg_roads_filtered <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"primary"</span>, <span class="st">"residential"</span>, <span class="st">"tertiary"</span>, <span class="st">"service"</span>, <span class="st">"secondary"</span>, <span class="st">"primary_link"</span>, <span class="st">"secondary_link"</span>, <span class="st">"tertiary_link"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sg_roads <span class="ot">&lt;-</span> sg_roads_all[sg_roads_all<span class="sc">$</span>fclass <span class="sc">%in%</span> sg_roads_filtered, ]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(sg_roads<span class="sc">$</span>fclass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(sg_roads, <span class="st">"data/rds/sg_roads.rds"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#sg_roads &lt;- read_rds("data/rds/sg_roads.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll save the output in .rds file format to save loading time.</p>
</div>
</div>
<p>We will now visualise the selected road types within the boundaries of Singapore using <code>tmap</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>road_type_palette <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">12</span>, <span class="st">"Set3"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(sg_sf) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">'grey'</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(sg_roads) <span class="sc">+</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"fclass"</span>, <span class="at">palette =</span> road_type_palette)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">main.title =</span> <span class="st">"Types of Road Networks in Singapore"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>✅ Task Complete! We have extracted the road layer within Singapore.</p>
</div>
</div>
</section>
</section>
<section id="importing-aspatial-datasets" class="level2">
<h2 class="anchored" data-anchor-id="importing-aspatial-datasets">2.4 Importing Aspatial Datasets</h2>
<section id="grab-posisi" class="level3">
<h3 class="anchored" data-anchor-id="grab-posisi">2.4.1 Grab-Posisi</h3>
<p>Grab-Posisi, is a GPS trajectory dataset. Each trajectory is serialised in a file in Apache Parquet format.</p>
<p>We will use the <code>read_parquet</code> function from the <code>arrow</code> package, to read Parquet files.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>grab0 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00000.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>grab1 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00001.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>grab2 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00002.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>grab3 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00003.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>grab4 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00004.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>grab5 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00005.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>grab6 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00006.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>grab7 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00007.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>grab8 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00008.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>grab9 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00009.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we join all the read files into one dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>grab <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(grab0,grab1, grab2,grab3,grab4,grab5,grab6,grab7,grab8,grab9) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(grab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>head</code> function reveals that there are 9 columns in the dataframe.</p>
<p>The field <code>pingtimestamp</code> is not in proper date-time format. It is stored as an <code>int</code> value. The following code chunk converts the data type of <code>pingtimestamp</code> from <code>int</code> to <code>date-time</code> format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>grab<span class="sc">$</span>pingtimestamp <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(grab<span class="sc">$</span>pingtimestamp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="converting-aspatial-data-frame-into-a-simple-feature-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="converting-aspatial-data-frame-into-a-simple-feature-data-frame">2.4.1.2 Converting Aspatial Data Frame into a Simple Feature Data Frame</h3>
<p>We will proceed to convert the <code>grab</code> dataset, currently in an aspatial data frame, into an sf tibble dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>grab_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(grab, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"rawlng"</span>, <span class="st">"rawlat"</span>),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write_rds(grab_sf, "data/rds/grab_sf.rds")</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>grab_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_sf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll save the output in .rds file format to save loading time.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Project Transformation</strong></p>
<p>Assuming the dataset is initially in the WGS84 Geographic Coordinate System, as indicated by the latitude/longitude fields, we need to define the suitable CRS for spatial analysis within Singapore. The <code>st_transform()</code> function is utilised to convert the CRS of the <code>grab</code> dataset to SVY21 (EPSG: 3414).</p>
</div>
</div>
<p>This gives us the new simple feature data frame, <code>grab_sf</code></p>
</section>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">2.5 Data Wrangling</h2>
<section id="extracting-grab-trips-starting-locations" class="level3">
<h3 class="anchored" data-anchor-id="extracting-grab-trips-starting-locations">2.5.1 <strong>Extracting Grab Trips Starting Locations</strong></h3>
<p>We will extract trip starting point for all unqiue trajectories and store them to a new df named <code>grab_origin</code>. To isolate the origin locations, we use the following methodology:</p>
<ol type="1">
<li><p><strong>Grouping by Trajectory ID:</strong></p>
<ul>
<li>The dataset is grouped by the unique trajectory identifier (<strong><code>trj_id</code></strong>).</li>
</ul></li>
<li><p><strong>Arranging by Timestamp:</strong></p>
<ul>
<li>Within each trajectory group, records are arranged in ascending order based on the timestamp (<strong><code>pingtimestamp</code></strong>).</li>
</ul></li>
<li><p><strong>Filtering for the First Row:</strong></p>
<ul>
<li>By selecting the first row within each grouped trajectory (<strong><code>row_number() == 1</code></strong>), we identify the earliest recorded location for each trip. This is indicative of the trip’s starting point.</li>
</ul></li>
<li><p><strong>Adding Temporal Information:</strong></p>
<ul>
<li><p>Additional temporal context is provided by introducing new columns:</p>
<ul>
<li><p><strong><code>weekday</code></strong>: Day of the week based on the timestamp</p></li>
<li><p><strong><code>start_hr</code></strong>: Starting hour of the trip</p></li>
<li><p><strong><code>day</code></strong>: Day of the month when the trip started</p></li>
</ul></li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>grab_origin <span class="ot">&lt;-</span> grab_sf <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trj_id) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(pingtimestamp) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co">#after sorting by timestamp, first row gives origin location </span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">wday</span>(pingtimestamp, <span class="co">#define workday</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">abbr =</span> <span class="cn">TRUE</span>), <span class="co">#Monday = MON </span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">start_hr =</span> <span class="fu">factor</span>(<span class="fu">hour</span>(pingtimestamp)),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">day =</span> <span class="fu">factor</span>(<span class="fu">mday</span>(pingtimestamp))) <span class="co">#to change to ordinal scale</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(grab_origin, "data/rds/grab_origin.rds")</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>grab_origin <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_origin.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll save the output in .rds file format to save loading time.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>✅ Task Complete! We have retrieved the origin location coordinates for Grab services.</p>
</div>
</div>
</section>
<section id="extracting-grab-trips-ending-locations" class="level3">
<h3 class="anchored" data-anchor-id="extracting-grab-trips-ending-locations">2.5.2 <strong>Extracting Grab Trips Ending Locations</strong></h3>
<p>We will extract trip ending point for all unique trajectories and store them to a new df named <code>grab_dest</code>. We employ a similar methodology to extracting a trips origin location. Except here, within each trajectory group, records are arranged in descending order based on the timestamp (<strong><code>pingtimestamp</code></strong>). By selecting the first row within each grouped trajectory (<strong><code>row_number() == 1</code></strong>), we identify the latest recorded location for each trip. This corresponds to the trip’s ending point.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>grab_dest <span class="ot">&lt;-</span> grab_sf <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trj_id) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pingtimestamp)) <span class="sc">%&gt;%</span> <span class="co">#function from dplyr</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co">#first row after arranging in desc order gives dest  </span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">wday</span>(pingtimestamp, <span class="co">#define workday</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">abbr =</span> <span class="cn">TRUE</span>), <span class="co">#Monday = MON </span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">end_hr =</span> <span class="fu">factor</span>(<span class="fu">hour</span>(pingtimestamp)),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">day =</span> <span class="fu">factor</span>(<span class="fu">mday</span>(pingtimestamp))) <span class="co">#to change to ordinal scale</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(grab_dest, "data/rds/grab_dest.rds")</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>grab_dest <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_dest.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll save the output in .rds file format to save loading time.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>✅ Task Complete! We have retrieved the destination location coordinates for Grab services.</p>
</div>
</div>
</section>
<section id="converting-simple-features-to-planar-point-pattern-objects" class="level3">
<h3 class="anchored" data-anchor-id="converting-simple-features-to-planar-point-pattern-objects">2.5.3 Converting Simple Features to Planar Point Pattern Objects</h3>
<p>To perform spatial point pattern analysis, firstly, we’ll need to convert the simple features objects (grab_orign and grab_dest) into Spatial* classes. For this we use <code>as.ppp</code> from spatstat package. The <code>st_coordinates</code> function extracts the coordiates from our sf objects and <code>st_bbox</code> will extract the minimum and maximum coordinates of the object along each axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>grab_origin_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(grab_origin), <span class="fu">st_bbox</span>(grab_origin))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grab_origin_ppp, <span class="at">main =</span> <span class="st">"Grab Origin Points as PPP Objects"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>grab_dest_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(grab_dest), <span class="fu">st_bbox</span>(grab_dest))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grab_dest_ppp, <span class="at">main =</span> <span class="st">"Grab Destination Points as PPP Objects"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is not neccessary to change <code>sg_sf</code> into a ppp object as it will be converted to <code>owin</code> instead.</p>
</div>
</div>
</section>
<section id="check-for-duplicates-and-handle-data-errors" class="level3">
<h3 class="anchored" data-anchor-id="check-for-duplicates-and-handle-data-errors">2.5.4 Check for Duplicates and Handle Data Errors</h3>
<p>Let’s have a look at the <code>ppp</code> objects we have created to make sure that there is no duplicates or errors in our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(grab_origin_ppp)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(grab_dest_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>grab_origin_ppp</code> and <code>grab_dest_ppp</code> objects have no duplicated points, but just to be sure, we check again using the <code>any(duplicated()</code> function.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(grab_origin_ppp)) </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(grab_dest_ppp)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output is false for both objects so we move on to the next step.</p>
</section>
<section id="introducing-owin" class="level3">
<h3 class="anchored" data-anchor-id="introducing-owin">2.5.5 Introducing OWIN</h3>
<p>When analysing spatial point patterns, we’ll confine our analysis within a certain geographical area - such as the Singapore boundary. In spatstat, an object called <code>owin</code> is specially designed to represent this polygonal region.</p>
</section>
<section id="creating-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="creating-owin-object">2.5.5.1 Creating OWIN Object</h3>
<p>To create a two dimensional observation window using <code>sg_sf</code> coastal boundary we created earlier, we use the <code>as.owin</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sg_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(sg_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(sg_owin, "data/rds/sg_owin")</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>sg_owin <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/sg_owin"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sg_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll save the output in .rds file format to save loading time.</p>
</div>
</div>
</section>
<section id="combining-point-events-and-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="combining-point-events-and-owin-object">2.5.5.2 Combining Point Events and OWIN Object</h3>
<p>Now, we’ll extract the relevant point events that are located within Singapore.</p>
</section>
<section id="origin-points-in-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="origin-points-in-owin-object">2.5.5.2.1 Origin Points in OWIN Object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>grab_origin_ppp_sg <span class="ot">&lt;-</span> grab_origin_ppp[sg_owin]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(grab_origin_ppp_sg, "data/rds/grab_origin_ppp_sg.rds")</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>grab_origin_ppp_sg <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_origin_ppp_sg.rds"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grab_origin_ppp_sg, <span class="at">main =</span> <span class="st">'[OWIN] Grab Origin Points'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll save the output in .rds file format to save loading time.</p>
</div>
</div>
</section>
<section id="destination-points-in-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="destination-points-in-owin-object">2.5.5.2.1 Destination Points in OWIN Object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>grab_dest_ppp_sg <span class="ot">&lt;-</span> grab_dest_ppp[sg_owin]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(grab_dest_ppp_sg, "data/rds/grab_dest_ppp_sg.rds")</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>grab_dest_ppp_sg <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_dest_ppp_sg.rds"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grab_dest_ppp_sg, <span class="at">main =</span> <span class="st">'[OWIN] Grab Destination Points'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll save the output in .rds file format to save loading time.</p>
</div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">3.0 Exploratory Data Analysis</h2>
<p>To better understand the spatial data, we employ a series of exploratory techniques.</p>
<section id="spatial-relationship-between-origin-and-destination-points" class="level3">
<h3 class="anchored" data-anchor-id="spatial-relationship-between-origin-and-destination-points">3.1 Spatial Relationship between Origin and Destination Points</h3>
<p>The map below shows the geographical distribution of origin and destination points. By overlaying both sets of points, we can observe areas where origin and destination locations overlap. These overlapping areas indicate regions with bidirectional travel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>combined_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> grab_origin, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Origin"</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> grab_dest, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Destination"</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Spatial Relationship Between Origin and Destination Locations"</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Location Type"</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Origin"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Destination"</span> <span class="ot">=</span> <span class="st">"red"</span>), </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Location Type"</span>, </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Origin"</span>, <span class="st">"Destination"</span>)) <span class="sc">+</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="spatio-temporal-visualisations" class="level3">
<h3 class="anchored" data-anchor-id="spatio-temporal-visualisations">3.2 Spatio-Temporal Visualisations</h3>
<p>Spatio-temporal visualisations show us a view of how data evolves over both space and time. These visualisations are particularly useful for analysing patterns, trends, and relationships within datasets.</p>
</section>
<section id="frequency-of-trip-by-hour" class="level3">
<h3 class="anchored" data-anchor-id="frequency-of-trip-by-hour">3.2.1 Frequency of Trip by Hour</h3>
<p>Let’s create interactive plots to provide an insightful representation of the distribution of origin/destination locations and emphasise the specific hours that stand out in terms of pickup/drop-off frequency.</p>
</section>
<section id="origin-or-pickup-frequency" class="level3">
<h3 class="anchored" data-anchor-id="origin-or-pickup-frequency">3.2.1.1 Origin or Pickup Frequency</h3>
<p>For creating a bar plot with <code>ggplot</code>, the pickup hours are first converted to numeric values for analysis. TThe x-axis represents the pickup hours, and the y-axis represents the count of origin locations. To highlight the hours with the highest count with a visual indication, we add a red dashed vertical line on the plot. The <strong><code>ggplot</code></strong> object is then converted into an interactive plot using <strong><code>ggplotly</code></strong>, allowing users to hover over bars for detailed information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>grab_origin<span class="sc">$</span>start_hr <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(grab_origin<span class="sc">$</span>start_hr)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>org<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grab_origin, <span class="fu">aes</span>(<span class="at">x =</span> start_hr)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Origin Locations by Pickup Hour"</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Pickup Hour"</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>max_hour <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">table</span>(grab_origin<span class="sc">$</span>start_hr))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>org <span class="ot">&lt;-</span> org <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> max_hour, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>org <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(org)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>org</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The chart above indicates that most pickups occur at 2-3pm, a potential reason could include:</p>
<blockquote class="blockquote">
<p><strong>After-School Activities</strong>: this time period may coincide with school release times and after-school activities. Parents might be picking up children or transporting them to various activities.</p>
</blockquote>
</section>
<section id="destination-or-drop-off-frequency" class="level3">
<h3 class="anchored" data-anchor-id="destination-or-drop-off-frequency">3.2.1.2 Destination or Drop-off Frequency</h3>
<p>For creating a bar plot with <code>ggplot</code>, the drop-off hours are first converted to numeric values for analysis. TThe x-axis represents the drop-off hours, and the y-axis represents the count of destination locations. To highlight the hours with the highest count with a visual indication, we add a red dashed vertical line on the plot. The <strong><code>ggplot</code></strong> object is then converted into an interactive plot using <strong><code>ggplotly</code></strong>, allowing users to hover over bars for detailed information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>grab_dest<span class="sc">$</span>end_hr <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(grab_dest<span class="sc">$</span>end_hr)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>dest<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grab_dest, <span class="fu">aes</span>(<span class="at">x =</span> end_hr)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Destinatioon Locations by Drop-off Hour"</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drop-off Hour"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>max_hour <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">table</span>(grab_dest<span class="sc">$</span>end_hr))</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>dest <span class="ot">&lt;-</span> dest <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> max_hour, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>dest <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(dest)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>dest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The chart above indicates that most drop-offs occur at 2pm, a potential reason could include:</p>
<blockquote class="blockquote">
<p><strong>Lunchtime Rush</strong>: 2pm is often around the time people finish their lunch breaks. This could result in increased travel demand as people return to work or resume their activities.</p>
</blockquote>
</section>
<section id="frequency-of-trip-by-day-of-week" class="level3">
<h3 class="anchored" data-anchor-id="frequency-of-trip-by-day-of-week">3.2.2 Frequency of Trip by Day of Week</h3>
<p>Let’s create a bar chart to explore the frequency of origins/destinations across different days and identify any noteworthy patterns.</p>
</section>
<section id="origin-or-pickup-frequency-by-days" class="level3">
<h3 class="anchored" data-anchor-id="origin-or-pickup-frequency-by-days">3.2.2.1 Origin or Pickup Frequency by Days</h3>
<p>The code uses <code>ggplot</code> to create a bar plot, where each bar represents the frequency of pickups on a specific day. This code produces a informative visualisation to explore patterns in pickup frequency throughout the week.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>origin_day <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grab_origin, <span class="fu">aes</span>(<span class="at">x =</span> weekday))  <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#4C78A8"</span>, <span class="at">color =</span> <span class="st">"#4C78A8"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frequency of Pickup by Day of Week"</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"Day"</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">theme_minimal</span>()</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>origin_day <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(origin_day)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>origin_day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>The distribution of trips across days appears generally uniform, with a subtle increase observed on Wednesdays.</p>
</blockquote>
</section>
<section id="destination-or-drop-off-frequency-by-days" class="level3">
<h3 class="anchored" data-anchor-id="destination-or-drop-off-frequency-by-days">3.2.2.2 Destination or Drop-off Frequency by Days</h3>
<p>The code uses <code>ggplot</code> to create a bar plot, where each bar represents the frequency of drop-offs on a specific day. This code produces a informative visualisation to explore patterns in drop-off frequency throughout the week.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dest_day <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grab_dest, <span class="fu">aes</span>(<span class="at">x =</span> weekday))  <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#FF0000"</span>, <span class="at">color =</span> <span class="st">"#FF0000"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frequency of Drop-off by Day of Week"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"Day"</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">theme_minimal</span>()</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>dest_day <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(dest_day)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>dest_day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>If we plot by destination, we see the same result. This is expected, considering that each trip’s origin corresponds to a destination.</p>
</blockquote>
</section>
</section>
<section id="first-order-spatial-point-patterns-analysis" class="level2">
<h2 class="anchored" data-anchor-id="first-order-spatial-point-patterns-analysis"><strong>4.0 First-Order Spatial Point Patterns Analysis</strong></h2>
<p>First-order spatial point pattern analysis focuses on the distribution of individual points in a given spatial domain. It involves examining the basic characteristics and properties of the point pattern itself, without considering the interactions or relationship between points.</p>
<section id="rescale-grab_original_ppp_sg-and-grab_dest_ppp_sg" class="level3">
<h3 class="anchored" data-anchor-id="rescale-grab_original_ppp_sg-and-grab_dest_ppp_sg"><strong>4.1</strong> Rescale <code>grab_original_ppp_sg</code> and <code>grab_dest_ppp_sg</code></h3>
<p>For further analysis, it is necessary to convert our data to kilometers, and we can achieve this by utilising the <code>rescale</code> function on <code>grab_original_ppp_sg</code> and <code>grab_dest_ppp_sg</code> which are in metres.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>grab_origin_ppp_sg_km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(grab_origin_ppp_sg, <span class="dv">1000</span>, <span class="st">'km'</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>grab_dest_ppp_sg_km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(grab_dest_ppp_sg, <span class="dv">1000</span>, <span class="st">'km'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(grab_origin_ppp_sg_km, "data/rds/grab_origin_ppp_sg_km.rds")</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>grab_origin_ppp_sg_km <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_origin_ppp_sg_km.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll save the output in .rds file format to save loading time.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(grab_dest_ppp_sg_km, "data/rds/grab_dest_ppp_sg_km.rds")</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>grab_dest_ppp_sg_km <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_dest_ppp_sg_km.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll save the output in .rds file format to save loading time.</p>
</div>
</div>
<blockquote class="blockquote">
<p><a href="https://is415-gaa-fathima.netlify.app/take-home_ex/take-home_ex01/take-home_ex01b"><strong>Proceed to Take-home Exercise 1b: Analysis</strong></a></p>
</blockquote>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>