<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>IS415 - GAA - Take-home Exercise 1: Application of Spatial Point Patterns Analysis to Discover the Geographical Distribution of Grab Hailing Services in Singapore</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../../site_libs/jquery-1.12.4/jquery.min.js"></script>
<link href="../../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../../site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="../../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../../site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../../site_libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="../../site_libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="../../site_libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415 - GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex3.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03-NKDE.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About Me!</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1 Overview</a>
  <ul class="collapse">
  <li><a href="#setting-the-scene" id="toc-setting-the-scene" class="nav-link" data-scroll-target="#setting-the-scene">1.1 Setting the scene</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.2 Objectives</a></li>
  </ul></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">2 Getting Started</a>
  <ul class="collapse">
  <li><a href="#data-acquisition" id="toc-data-acquisition" class="nav-link" data-scroll-target="#data-acquisition">2.1 Data Acquisition</a></li>
  <li><a href="#importing-relevant-r-packages" id="toc-importing-relevant-r-packages" class="nav-link" data-scroll-target="#importing-relevant-r-packages"><strong>2.2 Importing Relevant R Packages</strong></a></li>
  <li><a href="#importing-geospatial-datasets" id="toc-importing-geospatial-datasets" class="nav-link" data-scroll-target="#importing-geospatial-datasets">2.3 Importing Geospatial Datasets</a></li>
  <li><a href="#master-plan-2019-subzone-boundary-no-sea" id="toc-master-plan-2019-subzone-boundary-no-sea" class="nav-link" data-scroll-target="#master-plan-2019-subzone-boundary-no-sea">2.3.1 Master Plan 2019 Subzone Boundary (No Sea)</a></li>
  <li><a href="#coastal-outline" id="toc-coastal-outline" class="nav-link" data-scroll-target="#coastal-outline">2.3.2 Coastal Outline</a></li>
  <li><a href="#extracting-outer-islands" id="toc-extracting-outer-islands" class="nav-link" data-scroll-target="#extracting-outer-islands">2.3.2.1 Extracting outer islands</a></li>
  <li><a href="#rendering-a-coastal-boundary-excluding-outer-islands" id="toc-rendering-a-coastal-boundary-excluding-outer-islands" class="nav-link" data-scroll-target="#rendering-a-coastal-boundary-excluding-outer-islands">2.3.2.2 Rendering a Coastal Boundary Excluding Outer Islands</a></li>
  <li><a href="#open-street-map-road-data" id="toc-open-street-map-road-data" class="nav-link" data-scroll-target="#open-street-map-road-data">2.3.3 Open Street Map Road Data</a></li>
  <li><a href="#importing-aspatial-datasets" id="toc-importing-aspatial-datasets" class="nav-link" data-scroll-target="#importing-aspatial-datasets">2.4 Importing Aspatial Datasets</a></li>
  <li><a href="#grab-posisi" id="toc-grab-posisi" class="nav-link" data-scroll-target="#grab-posisi">2.4.1 Grab-Posisi</a></li>
  <li><a href="#converting-aspatial-data-frame-into-a-simple-feature-data-frame" id="toc-converting-aspatial-data-frame-into-a-simple-feature-data-frame" class="nav-link" data-scroll-target="#converting-aspatial-data-frame-into-a-simple-feature-data-frame">2.4.1.2 Converting Aspatial Data Frame into a Simple Feature Data Frame</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">2.4.2 Data Wrangling</a></li>
  <li><a href="#extracting-grab-trips-starting-locations" id="toc-extracting-grab-trips-starting-locations" class="nav-link" data-scroll-target="#extracting-grab-trips-starting-locations">2.4.2.1 <strong>Extracting Grab Trips Starting Locations</strong></a></li>
  <li><a href="#extracting-trip-ending-locations" id="toc-extracting-trip-ending-locations" class="nav-link" data-scroll-target="#extracting-trip-ending-locations">2.4.2.2 <strong>Extracting Trip Ending Locations</strong></a></li>
  <li><a href="#converting-simple-features-to-planar-point-pattern-objects" id="toc-converting-simple-features-to-planar-point-pattern-objects" class="nav-link" data-scroll-target="#converting-simple-features-to-planar-point-pattern-objects">Converting Simple Features to Planar Point Pattern Objects</a></li>
  <li><a href="#check-for-duplicates-and-handle-data-errors" id="toc-check-for-duplicates-and-handle-data-errors" class="nav-link" data-scroll-target="#check-for-duplicates-and-handle-data-errors">Check for duplicates and Handle Data Errors</a></li>
  <li><a href="#introducing-the-owin-object" id="toc-introducing-the-owin-object" class="nav-link" data-scroll-target="#introducing-the-owin-object">Introducing the owin object</a></li>
  <li><a href="#creating-owin-object" id="toc-creating-owin-object" class="nav-link" data-scroll-target="#creating-owin-object">Creating owin object</a></li>
  <li><a href="#combining-point-events-and-owin-object" id="toc-combining-point-events-and-owin-object" class="nav-link" data-scroll-target="#combining-point-events-and-owin-object">Combining Point Events and OWIN Object</a></li>
  <li><a href="#exploratoty-data-analysis" id="toc-exploratoty-data-analysis" class="nav-link" data-scroll-target="#exploratoty-data-analysis">Exploratoty Data Analysis</a></li>
  <li><a href="#first-order-spatial-point-patterns-analysis" id="toc-first-order-spatial-point-patterns-analysis" class="nav-link" data-scroll-target="#first-order-spatial-point-patterns-analysis"><strong>First-Order Spatial Point Patterns Analysis</strong></a></li>
  <li><a href="#kernel-density-estimation" id="toc-kernel-density-estimation" class="nav-link" data-scroll-target="#kernel-density-estimation">Kernel Density Estimation</a></li>
  <li><a href="#automatic-bandwidth-method" id="toc-automatic-bandwidth-method" class="nav-link" data-scroll-target="#automatic-bandwidth-method">Automatic bandwidth method</a></li>
  <li><a href="#other-spatstat-functions-for-bandwidth" id="toc-other-spatstat-functions-for-bandwidth" class="nav-link" data-scroll-target="#other-spatstat-functions-for-bandwidth">Other spatstat functions for bandwidth</a></li>
  <li><a href="#choosing-the-most-appropriate-kde-selection-method" id="toc-choosing-the-most-appropriate-kde-selection-method" class="nav-link" data-scroll-target="#choosing-the-most-appropriate-kde-selection-method">Choosing the most appropriate KDE Selection Method</a></li>
  <li><a href="#fixed-bandwidth-selection" id="toc-fixed-bandwidth-selection" class="nav-link" data-scroll-target="#fixed-bandwidth-selection">Fixed Bandwidth Selection</a></li>
  <li><a href="#different-kernel-function-selection-methods-for-fixed-bandwidth" id="toc-different-kernel-function-selection-methods-for-fixed-bandwidth" class="nav-link" data-scroll-target="#different-kernel-function-selection-methods-for-fixed-bandwidth">Different Kernel Function Selection Methods for Fixed Bandwidth</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#kde-layers-with-spatially-adaptive-bandwidth" id="toc-kde-layers-with-spatially-adaptive-bandwidth" class="nav-link" data-scroll-target="#kde-layers-with-spatially-adaptive-bandwidth">KDE Layers with Spatially Adaptive Bandwidth</a></li>
  </ul></li>
  <li><a href="#comparing-fixed-bandwidth-and-adaptive" id="toc-comparing-fixed-bandwidth-and-adaptive" class="nav-link" data-scroll-target="#comparing-fixed-bandwidth-and-adaptive">Comparing Fixed Bandwidth and Adaptive</a>
  <ul class="collapse">
  <li><a href="#interactive-kde-maps" id="toc-interactive-kde-maps" class="nav-link" data-scroll-target="#interactive-kde-maps">Interactive KDE Maps</a></li>
  <li><a href="#converting-kde-output-into-grid-object-into-rasterlayer-object" id="toc-converting-kde-output-into-grid-object-into-rasterlayer-object" class="nav-link" data-scroll-target="#converting-kde-output-into-grid-object-into-rasterlayer-object">Converting KDE output into grid object into RasterLayer object</a></li>
  <li><a href="#kernel-density-maps-on-openstreetmap" id="toc-kernel-density-maps-on-openstreetmap" class="nav-link" data-scroll-target="#kernel-density-maps-on-openstreetmap">Kernel Density Maps on OpenStreetMap</a></li>
  <li><a href="#kernel-density-map-analysis" id="toc-kernel-density-map-analysis" class="nav-link" data-scroll-target="#kernel-density-map-analysis">Kernel Density Map Analysis</a></li>
  <li><a href="#comparing-spatial-point-patterns-using-kde" id="toc-comparing-spatial-point-patterns-using-kde" class="nav-link" data-scroll-target="#comparing-spatial-point-patterns-using-kde"><strong>Comparing Spatial Point Patterns using KDE</strong></a></li>
  <li><a href="#extract-planning-areas" id="toc-extract-planning-areas" class="nav-link" data-scroll-target="#extract-planning-areas">Extract Planning Areas</a></li>
  <li><a href="#plotting-target-planning-areas" id="toc-plotting-target-planning-areas" class="nav-link" data-scroll-target="#plotting-target-planning-areas">Plotting target planning areas</a></li>
  <li><a href="#nearest-neighbour-analysis" id="toc-nearest-neighbour-analysis" class="nav-link" data-scroll-target="#nearest-neighbour-analysis">Nearest Neighbour Analysis</a></li>
  <li><a href="#clark-evans-test-of-aggregation" id="toc-clark-evans-test-of-aggregation" class="nav-link" data-scroll-target="#clark-evans-test-of-aggregation">Clark-Evans test of aggregation</a></li>
  <li><a href="#origin-points" id="toc-origin-points" class="nav-link" data-scroll-target="#origin-points">Origin Points</a></li>
  <li><a href="#destination-points" id="toc-destination-points" class="nav-link" data-scroll-target="#destination-points">Destination Points</a></li>
  <li><a href="#network-constrained-kernel-density-estimation-nkde" id="toc-network-constrained-kernel-density-estimation-nkde" class="nav-link" data-scroll-target="#network-constrained-kernel-density-estimation-nkde"><strong>Network Constrained Kernel Density Estimation (NKDE)</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 1: Application of Spatial Point Patterns Analysis to Discover the Geographical Distribution of Grab Hailing Services in Singapore</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>1 Overview</h1>
<section id="setting-the-scene" class="level2">
<h2 class="anchored" data-anchor-id="setting-the-scene">1.1 Setting the scene</h2>
<p>Understanding how people move around in a city is like figuring out its heartbeat—it shows us the rhythms that shape our urban lives. Thanks to smartphones and technology, we now have a bunch of data about how people move. When we use smart analysis tools like GIS, we can unlock valuable insights that help us plan cities better.</p>
<p>In 2020, GRAB shared a set of data called Grab Posisi, all about how people move around in Singapore. This kind of information isn’t just interesting; it’s super helpful for businesses, people who make decisions about the city, and those who plan how cities work. It’s like having a dynamic picture of how people move, helping us create cities that work well for everyone.</p>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">1.2 Objectives</h2>
<p>The objectives of this exercise are to:</p>
<ul>
<li><p>Apply geospatial analytics to address societal challenges</p></li>
<li><p>Use spatial point patterns analysis methods to explore Grab hailing services distribution in Singapore</p></li>
<li><p>Organise geospatial data into sf tibble data.frames using sf and tidyverse functions</p></li>
<li><p>Focus on Grab taxi location points, road layer within Singapore, and Singapore boundary layer</p></li>
<li><p>Generate traditional Kernel Density Estimation layers from the extracted data</p></li>
<li><p>Create either Network Kernel Density Estimation (NKDE)</p></li>
<li><p>Utilise tmap functions to display kernel density layers on an openstreetmap of Singapore</p></li>
<li><p>Describe spatial patterns revealed by the kernel density maps</p></li>
</ul>
<p>By this exercise, I will:</p>
<ul>
<li><p>Enhance my understanding of geospatial analytics applications</p></li>
<li><p>Develop proficiency in spatial point patterns analysis</p></li>
<li><p>Gain hands-on experience in organising geospatial data using sf and tidyverse functions</p></li>
<li><p>Explore Grab hailing services distribution patterns in Singapore</p></li>
<li><p>Generate and interpret Kernel Density Estimation layers</p></li>
<li><p>Understand the nuances of Network Kernel Density Estimation (NKDE)</p></li>
<li><p>Master the visualisation of spatial patterns using tmap functions on an openstreetmap</p></li>
</ul>
</section>
</section>
<section id="getting-started" class="level1">
<h1>2 Getting Started</h1>
<section id="data-acquisition" class="level2">
<h2 class="anchored" data-anchor-id="data-acquisition">2.1 Data Acquisition</h2>
<p>The study will utilise the following datasets to explore spatial point patterns analysis methods and reveal the geographical and spatio-temporal distribution of Grab hailing services locations in Singapore.</p>
<table class="table">
<thead>
<tr class="header">
<th>Dataset Name</th>
<th>Type</th>
<th>Source</th>
<th>Path</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Grab-Posisi</td>
<td>Aspatial (.parquet)</td>
<td><a href="https://engineering.grab.com/grab-posisi" class="uri">https://engineering.grab.com/grab-posisi</a></td>
<td>data/aspatial/grabPosisi</td>
</tr>
<tr class="even">
<td>Master Plan 2019 Subzone Boundary (No Sea)</td>
<td>Geospatial (.shp)</td>
<td><a href="https://beta.data.gov.sg/collections/2104/view" class="uri">https://beta.data.gov.sg/collections/2104/view</a></td>
<td>data/geospatial/MPSZ-2019</td>
</tr>
<tr class="odd">
<td>Open Street Map Raod Data</td>
<td>Geospatial (.shp)</td>
<td><a href="https://download.geofabrik.de/asia/malaysia-singapore-brunei.html" class="uri">https://download.geofabrik.de/asia/malaysia-singapore-brunei.html</a></td>
<td>data/geospatial/OSM/gis_osm_roads_free_1</td>
</tr>
</tbody>
</table>
</section>
<section id="importing-relevant-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="importing-relevant-r-packages"><strong>2.2 Importing Relevant R Packages</strong></h2>
<p>The R packages used in this project are:</p>
<ul>
<li><p><code>sf</code>: for importing, managing, and processing geospatial data.</p></li>
<li><p><code>tidyverse</code>: a family of other R packages for performing data science tasks such as importing, wrangling, and visualising data.</p></li>
<li><p><code>tmap</code>: creating thematic maps</p></li>
<li><p><code>maptools</code>: a set of tools for manipulating geographic data</p></li>
<li><p><code>raster</code>: reads, writes, manipulates, analyses, and model gridded spatial data (raster)</p></li>
<li><p><code>spatstat</code>: for performing spatial point patterns analysis</p></li>
<li><p><code>dplyr</code></p></li>
<li><p><code>arrow</code></p></li>
<li><p><code>lubridate</code>: undefined</p></li>
<li><p><code>rgdal</code></p></li>
<li><p><code>RcolorBrewer</code></p></li>
</ul>
<p>Pacman assists us by helping us load R packages that we require.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>  pacman<span class="sc">::</span><span class="fu">p_load</span>(arrow, lubridate, tidyverse, tmap, sf, maptools, spatstat, raster, dplyr, rmapshaper, RColorBrewer)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#update.packages(ask = FALSE, dependencies = TRUE)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages("maptools", repos = "https://packagemanager.posit.co/cran/2023-10-13")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="importing-geospatial-datasets" class="level2">
<h2 class="anchored" data-anchor-id="importing-geospatial-datasets">2.3 Importing Geospatial Datasets</h2>
</section>
<section id="master-plan-2019-subzone-boundary-no-sea" class="level2">
<h2 class="anchored" data-anchor-id="master-plan-2019-subzone-boundary-no-sea">2.3.1 Master Plan 2019 Subzone Boundary (No Sea)</h2>
<p>For the shapefile format, two arguments are required:&nbsp;<code>dsn</code>&nbsp;to define the data path, and&nbsp;<code>layer</code>&nbsp;to provide the shapefile name.&nbsp;</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mpsz_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"MPSZ-2019"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MPSZ-2019' from data source 
  `C:\fathimak2020\IS415-GAA\Take-home_Ex\Take-home_Ex01\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 332 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Project Transformation</strong></p>
<p>Given that our dataset corresponds to the geographical boundaries of Singapore, it is necessary to specify the appropriate CRS for accurate spatial analysis. To achieve this, the <strong><code>st_transform()</code></strong> function is used to convert the CRS of <code>mpsz_sf</code> to SVY21 (EPSG: 3414)</p>
</div>
</div>
</section>
<section id="coastal-outline" class="level2">
<h2 class="anchored" data-anchor-id="coastal-outline">2.3.2 Coastal Outline</h2>
<p>In order to create a costal outline of singapore, we will use the <code>st_union</code> function to consolidate all subzone boundaries into a single polygon.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>outline <span class="ot">=</span> mpsz_sf <span class="sc">%&gt;%</span> <span class="fu">st_union</span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(outline)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="extracting-outer-islands" class="level2">
<h2 class="anchored" data-anchor-id="extracting-outer-islands">2.3.2.1 Extracting outer islands</h2>
<p>As seen in the figure above, the coastal outline includes outer islands where Grab service is unavailable. Through the code chunk below, we shall use the <code>subset</code> function to select planning subzones from the <code>mpsz_sf</code> dataset to exclude. These rows of data are stored in new dataframes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>semakau <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf,mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span> <span class="st">"SEMAKAU"</span>) <span class="co">#western island</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sudong <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf, mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span> <span class="st">"SUDONG"</span>) <span class="co">#western island</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>bukom <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf, mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span>  <span class="st">"JURONG ISLAND AND BUKOM"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>north <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf, mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span> <span class="st">"NORTH-EASTERN ISLANDS"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>south <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf, mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span> <span class="st">"SOUTHERN GROUP"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We combine the newly created dataframes using the <code>bind_rows</code> function.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>outer <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(<span class="fu">list</span>(semakau,sudong,bukom,north,south))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="rendering-a-coastal-boundary-excluding-outer-islands" class="level2">
<h2 class="anchored" data-anchor-id="rendering-a-coastal-boundary-excluding-outer-islands">2.3.2.2 Rendering a Coastal Boundary Excluding Outer Islands</h2>
<p>We use the st_union function to merge the geometries of <code>mpsz_sf</code> and <code>outerislands</code> and the <code>st_difference</code> function to eliminate the overlap.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sg_sf <span class="ot">&lt;-</span> <span class="fu">st_difference</span>(<span class="fu">st_union</span>(mpsz_sf), <span class="fu">st_union</span>(outer))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sg_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>✅ Task Complete! We have extracted Singapore boundary layer excluding outer islands.</p>
</div>
</div>
</section>
<section id="open-street-map-road-data" class="level2">
<h2 class="anchored" data-anchor-id="open-street-map-road-data">2.3.3 Open Street Map Road Data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>allroads <span class="ot">=</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/OSM"</span>, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">layer =</span> <span class="st">"gis_osm_roads_free_1"</span>)  <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `gis_osm_roads_free_1' from data source 
  `C:\fathimak2020\IS415-GAA\Take-home_Ex\Take-home_Ex01\data\geospatial\OSM' 
  using driver `ESRI Shapefile'
Simple feature collection with 1759836 features and 10 fields
Geometry type: LINESTRING
Dimension:     XY
Bounding box:  xmin: 99.66041 ymin: 0.8021131 xmax: 119.2601 ymax: 7.514393
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Project Transformation</strong></p>
<p>Given that our dataset corresponds to the geographical boundaries of Singapore, it’s necessary to specify the appropriate CRS for accurate spatial analysis. To achieve this, the <strong><code>st_transform()</code></strong> function is used to convert the CRS of <code>allroads</code> to SVY21 (EPSG: 3414)</p>
</div>
</div>
<p>This dataset encompasses road networks spanning Singapore, Malaysia, and Brunei. To narrow our focus, we will extract roads exclusively within the Singapore boundary using the <code>st_intersection</code> function.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sg_roads_all <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(allroads,sg_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will examine the road network’s road types.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(sg_roads_all<span class="sc">$</span>fclass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "primary"        "residential"    "tertiary"       "footway"       
 [5] "service"        "secondary"      "motorway"       "motorway_link" 
 [9] "trunk"          "trunk_link"     "primary_link"   "pedestrian"    
[13] "living_street"  "unclassified"   "steps"          "track_grade2"  
[17] "track"          "secondary_link" "cycleway"       "path"          
[21] "tertiary_link"  "track_grade1"   "track_grade3"   "unknown"       
[25] "track_grade5"   "bridleway"      "track_grade4"  </code></pre>
</div>
</div>
<p>Given our focus on Grab services, which primarily operate on roads excluding expressways, we will extract the relevant types from the road network. We can refer to OSM fclass to understand whichi roads are relevant here.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sg_roads_filtered <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"primary"</span>, <span class="st">"residential"</span>, <span class="st">"tertiary"</span>, <span class="st">"service"</span>, <span class="st">"secondary"</span>, <span class="st">"primary_link"</span>, <span class="st">"secondary_link"</span>, <span class="st">"tertiary_link"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sg_roads <span class="ot">&lt;-</span> sg_roads_all[sg_roads_all<span class="sc">$</span>fclass <span class="sc">%in%</span> sg_roads_filtered, ]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(sg_roads<span class="sc">$</span>fclass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "primary"        "residential"    "tertiary"       "service"       
[5] "secondary"      "primary_link"   "secondary_link" "tertiary_link" </code></pre>
</div>
</div>
<p>We will now visualise the selected road types within the boundaries of Singapore.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>road_type_palette <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">12</span>, <span class="st">"Set3"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(sg_sf) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">'grey'</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(sg_roads) <span class="sc">+</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"fclass"</span>, <span class="at">palette =</span> road_type_palette)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$frame
[1] FALSE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>✅ Task Complete! Road layer within Singapore excluding outer islands.</p>
</div>
</div>
</section>
<section id="importing-aspatial-datasets" class="level2">
<h2 class="anchored" data-anchor-id="importing-aspatial-datasets">2.4 Importing Aspatial Datasets</h2>
</section>
<section id="grab-posisi" class="level2">
<h2 class="anchored" data-anchor-id="grab-posisi">2.4.1 Grab-Posisi</h2>
<p>Grab-Posisi, is a GPS trajectory dataset. Each trajectory is serialised in a file in Apache Parquet format.&nbsp;</p>
<p>We will use the <code>read_parquet</code>&nbsp;function from the <code>arrow</code>&nbsp;package, to read Parquet files.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>grab0 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00000.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>grab1 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00001.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>grab2 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00002.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>grab3 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00003.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>grab4 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00004.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>grab5 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00005.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>grab6 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00006.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>grab7 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00007.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>grab8 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00008.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>grab9 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00009.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then we join all into one dataframe.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>grab <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(grab0,grab1, grab2,grab3,grab4,grab5,grab6,grab7,grab8,grab9) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(grab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  trj_id driving_mode osname  pingtimestamp rawlat rawlng speed bearing accuracy
  &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;           &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;int&gt;    &lt;dbl&gt;
1 70014  car          android    1554943236   1.34   104.  18.9     248      3.9
2 73573  car          android    1555582623   1.32   104.  17.7      44      4  
3 75567  car          android    1555141026   1.33   104.  14.0      34      3.9
4 1410   car          android    1555731693   1.26   104.  13.0     181      4  
5 4354   car          android    1555584497   1.28   104.  14.8      93      3.9
6 32630  car          android    1555395258   1.30   104.  23.2      73      3.9</code></pre>
</div>
</div>
<p>The <code>head</code> function reveals that there are 9 columns in the dataframe.</p>
<p>The field <code>pingtimestamp</code> is not in proper date-time format. It is stored as an <code>int</code> value. The following code chunk converts the data type of <code>pingtimestamp</code> from <code>int</code> to <code>date-time</code> format.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>grab<span class="sc">$</span>pingtimestamp <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(grab<span class="sc">$</span>pingtimestamp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="converting-aspatial-data-frame-into-a-simple-feature-data-frame" class="level2">
<h2 class="anchored" data-anchor-id="converting-aspatial-data-frame-into-a-simple-feature-data-frame">2.4.1.2 Converting Aspatial Data Frame into a Simple Feature Data Frame</h2>
<p>We will proceed to convert the <code>grab</code> dataset, currently in an aspatial data frame, into an sf tibble dataframe.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>grab_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(grab, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"rawlng"</span>, <span class="st">"rawlat"</span>),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write_rds(grab_sf, "data/rds/grab_sf.rds")</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>grab_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_sf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Project Transformation</strong></p>
<p>Assuming the dataset is initially in the WGS84 Geographic Coordinate System, as indicated by its latitude/longitude fields, we need to define the suitable CRS for spatial analysis within Singapore. The <code>st_transform()</code> function is utilised to convert the CRS of the <code>grab</code> dataset to SVY21 (EPSG: 3414).</p>
</div>
</div>
<p>This gives us the new simple feature data frame, <code>grab_sf</code></p>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">2.4.2 Data Wrangling</h2>
</section>
<section id="extracting-grab-trips-starting-locations" class="level2">
<h2 class="anchored" data-anchor-id="extracting-grab-trips-starting-locations">2.4.2.1 <strong>Extracting Grab Trips Starting Locations</strong></h2>
<p>We will extract trip starting point for all unqiue trajectories and store them to a new df named <code>grab_origin</code>. To isolate the origin locations, we employ the following methodology:</p>
<ol type="1">
<li><p><strong>Grouping by Trajectory ID:</strong></p>
<ul>
<li>The dataset is grouped by the unique trajectory identifier (<strong><code>trj_id</code></strong>).</li>
</ul></li>
<li><p><strong>Arranging by Timestamp:</strong></p>
<ul>
<li>Within each trajectory group, records are arranged in ascending order based on the timestamp (<strong><code>pingtimestamp</code></strong>).</li>
</ul></li>
<li><p><strong>Filtering for the First Row:</strong></p>
<ul>
<li>By selecting the first row within each grouped trajectory (<strong><code>row_number() == 1</code></strong>), we identify the earliest recorded location for each trip. This is indicative of the trip’s starting point.</li>
</ul></li>
<li><p><strong>Adding Temporal Information:</strong></p>
<ul>
<li><p>Additional temporal context is provided by introducing new columns:</p>
<ul>
<li><p><strong><code>weekday</code></strong>: Day of the week based on the timestamp.</p></li>
<li><p><strong><code>start_hr</code></strong>: Starting hour of the trip.</p></li>
<li><p><strong><code>day</code></strong>: Day of the month when the trip commenced.</p></li>
</ul></li>
</ul></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>grab_origin <span class="ot">&lt;-</span> grab_sf <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trj_id) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(pingtimestamp) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co">#after sorting by timestamp, first row gives origin location </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">wday</span>(pingtimestamp, <span class="co">#define workday</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">abbr =</span> <span class="cn">TRUE</span>), <span class="co">#Monday = MON </span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">start_hr =</span> <span class="fu">factor</span>(<span class="fu">hour</span>(pingtimestamp)),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">day =</span> <span class="fu">factor</span>(<span class="fu">mday</span>(pingtimestamp))) <span class="co">#to change to ordinal scale</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(grab_origin, "data/rds/grab_origin.rds")</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>grab_origin <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_origin.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>✅ Task Complete! Grab taxi location points by origin points.</p>
</div>
</div>
</section>
<section id="extracting-trip-ending-locations" class="level2">
<h2 class="anchored" data-anchor-id="extracting-trip-ending-locations">2.4.2.2 <strong>Extracting Trip Ending Locations</strong></h2>
<p>We will extract trip ending point for all unique trajectories and store them to a new df named <code>grab_dest</code>. We employ a similar methodology to extracting a trips origin location. Except here, within each trajectory group, records are arranged in descending order based on the timestamp (<strong><code>pingtimestamp</code></strong>). By selecting the first row within each grouped trajectory (<strong><code>row_number() == 1</code></strong>), we identify the latest recorded location for each trip. This corresponds to the trip’s ending point.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>grab_dest <span class="ot">&lt;-</span> grab_sf <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trj_id) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pingtimestamp)) <span class="sc">%&gt;%</span> <span class="co">#function from dplyr</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co">#first row after arranging in desc order gives dest  </span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">wday</span>(pingtimestamp, <span class="co">#define workday</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">abbr =</span> <span class="cn">TRUE</span>), <span class="co">#Monday = MON </span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">end_hr =</span> <span class="fu">factor</span>(<span class="fu">hour</span>(pingtimestamp)),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">day =</span> <span class="fu">factor</span>(<span class="fu">mday</span>(pingtimestamp))) <span class="co">#to change to ordinal scale</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(grab_dest, "data/rds/grab_dest.rds")</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>grab_dest <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_dest.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>✅ Task Complete! Grab taxi location points either by destination points.</p>
</div>
</div>
</section>
<section id="converting-simple-features-to-planar-point-pattern-objects" class="level2">
<h2 class="anchored" data-anchor-id="converting-simple-features-to-planar-point-pattern-objects">Converting Simple Features to Planar Point Pattern Objects</h2>
<p>Firstly, we’ll need to convert the simple features data frames into Spatial* classes so we can to do spatial point pattern analysis on it:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>grab_origin_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(grab_origin), <span class="fu">st_bbox</span>(grab_origin))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grab_origin_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>grab_dest_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(grab_dest), <span class="fu">st_bbox</span>(grab_dest))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grab_dest_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note: It is not neccessary to change <code>sg_sf</code> into a ppp object as it will be converted to <code>owin</code> instead.</p>
</div>
</div>
</section>
<section id="check-for-duplicates-and-handle-data-errors" class="level2">
<h2 class="anchored" data-anchor-id="check-for-duplicates-and-handle-data-errors">Check for duplicates and Handle Data Errors</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(grab_origin_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern:  28000 points
Average intensity 2.473666e-05 points per square unit

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [3628.24, 49845.23] x [25198.14, 49689.64] units
                    (46220 x 24490 units)
Window area = 1131920000 square units</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(grab_dest_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern:  28000 points
Average intensity 2.493661e-05 points per square unit

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [3637.21, 49870.63] x [25221.3, 49507.79] units
                    (46230 x 24290 units)
Window area = 1122850000 square units</code></pre>
</div>
</div>
<p>Note: grab_origin_ppp objects has no duplicated points, just to be sure, check again</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(grab_origin_ppp)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(grab_dest_ppp)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</section>
<section id="introducing-the-owin-object" class="level2">
<h2 class="anchored" data-anchor-id="introducing-the-owin-object">Introducing the owin object</h2>
<p>Usually, when analysing spatial point patterns, we’ll confine our analysis within a certain geographical area - such as the Singapore boundary. In spatstat, an object called owin is specially designed to represent this polygonal region.</p>
</section>
<section id="creating-owin-object" class="level2">
<h2 class="anchored" data-anchor-id="creating-owin-object">Creating owin object</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sg_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(sg_sf)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sg_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="combining-point-events-and-owin-object" class="level2">
<h2 class="anchored" data-anchor-id="combining-point-events-and-owin-object">Combining Point Events and OWIN Object</h2>
<p>Now, we’ll extract the relevant events that are located within Singapore.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>grab_origin_ppp_sg <span class="ot">&lt;-</span> grab_origin_ppp[sg_owin]</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grab_origin_ppp_sg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>grab_dest_ppp_sg <span class="ot">&lt;-</span> grab_dest_ppp[sg_owin]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grab_dest_ppp_sg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="exploratoty-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratoty-data-analysis">Exploratoty Data Analysis</h2>
<p>##Point Symbol Maps</p>
</section>
<section id="first-order-spatial-point-patterns-analysis" class="level2">
<h2 class="anchored" data-anchor-id="first-order-spatial-point-patterns-analysis"><strong>First-Order Spatial Point Patterns Analysis</strong></h2>
<p>##Rescale <code>grab_original_ppp_sg</code> and <code>grab_dest_ppp_sg</code></p>
<p><code>grab_original_ppp_sg</code> and <code>grab_dest_ppp_sg</code> is in metres. For futher analysis, we are required to rescale our data to kilometers, we can do so using <code>rescale().</code></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>grab_origin_ppp_sg_km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(grab_origin_ppp_sg, <span class="dv">1000</span>, <span class="st">'km'</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>grab_dest_ppp_sg_km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(grab_dest_ppp_sg, <span class="dv">1000</span>, <span class="st">'km'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="kernel-density-estimation" class="level2">
<h2 class="anchored" data-anchor-id="kernel-density-estimation">Kernel Density Estimation</h2>
</section>
<section id="automatic-bandwidth-method" class="level2">
<h2 class="anchored" data-anchor-id="automatic-bandwidth-method">Automatic bandwidth method</h2>
<p>Computing kernel density estimation using automatic bandwidth selection method</p>
<ul>
<li><a href="https://search.r-project.org/CRAN/refmans/spatstat.explore/html/bw.diggle.html"><code>bw.diggle()</code></a> Cross Validated Bandwidth Selection for Kernel Density</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>kde_grab_origin_sg_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_grab_origin_sg_bw,<span class="at">main =</span> <span class="st">"Automatic KDE for Origin Points"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>kde_grab_dest_sg_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_dest_ppp_sg_km,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_grab_dest_sg_bw,<span class="at">main =</span> <span class="st">"Automatic KDE for Destination Points"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="other-spatstat-functions-for-bandwidth" class="level2">
<h2 class="anchored" data-anchor-id="other-spatstat-functions-for-bandwidth">Other spatstat functions for bandwidth</h2>
<ul>
<li><p><a href="https://search.r-project.org/CRAN/refmans/spatstat.explore/html/bw.CvL.adaptive.html"><code>bw.CvL()</code></a> Cronie and van Lieshout’s Criterion for Bandwidth Selection for Kernel Density</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/bw.scott"><code>bw.scott()</code></a> Scott’s Rule for Bandwidth Selection for Kernel Density</p></li>
<li><p><a href="https://search.r-project.org/CRAN/refmans/spatstat.explore/html/bw.pplHeat.html"><code>bw.ppl()</code></a> Likelihood Cross Validation Bandwidth Selection for Kernel Density</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>bw_CvL <span class="ot">&lt;-</span> <span class="fu">bw.CvL</span>(grab_origin_ppp_sg_km)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>bw_CvL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   sigma 
3.147573 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>bw_scott <span class="ot">&lt;-</span> <span class="fu">bw.scott</span>(grab_origin_ppp_sg_km, <span class="at">isotropic=</span><span class="cn">TRUE</span>) <span class="co">#{r}to return single bandwidth as scott provides 2 different bandwidths for each coordinate</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>bw_scott</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   sigma 
1.222829 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>bw_ppl <span class="ot">&lt;-</span> <span class="fu">bw.ppl</span>(grab_origin_ppp_sg_km)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>bw_ppl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    sigma 
0.1238747 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>bw_diggle <span class="ot">&lt;-</span> <span class="fu">bw.diggle</span>(grab_origin_ppp_sg_km)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>bw_diggle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      sigma 
0.008098505 </code></pre>
</div>
</div>
<p>Comparing the output of each method&nbsp;methods</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>kde_diggle <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, bw_diggle)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>kde_CvL <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, bw_CvL)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>kde_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, bw_scott)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>kde_ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, bw_ppl)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_diggle,<span class="at">main =</span> <span class="st">"kde_diggle"</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_CvL,<span class="at">main =</span> <span class="st">"kde_CvL"</span>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_scott,<span class="at">main =</span> <span class="st">"kde_scott"</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_ppl,<span class="at">main =</span> <span class="st">"kde_ppl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(kde_diggle,<span class="at">main =</span> <span class="st">"kde_diggle"</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(kde_CvL,<span class="at">main =</span> <span class="st">"kde_CvL"</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(kde_scott,<span class="at">main =</span> <span class="st">"kde_scott"</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(kde_ppl,<span class="at">main =</span> <span class="st">"kde_ppl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="choosing-the-most-appropriate-kde-selection-method" class="level2">
<h2 class="anchored" data-anchor-id="choosing-the-most-appropriate-kde-selection-method">Choosing the most appropriate KDE Selection Method</h2>
<p>we choose scott method not much skewness from histogram</p>
</section>
<section id="fixed-bandwidth-selection" class="level2">
<h2 class="anchored" data-anchor-id="fixed-bandwidth-selection">Fixed Bandwidth Selection</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>fixed_bw_scott <span class="ot">&lt;-</span> <span class="fu">bw.scott</span>(grab_origin_ppp_sg_km)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>fixed_bw_scott</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  sigma.x   sigma.y 
1.5925974 0.9389125 </code></pre>
</div>
</div>
<p>The values returned are ___ and __</p>
<p>The we plot to visualised the fixed bandwdht using scott method</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, fixed_bw_scott)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed_bw_scott)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="different-kernel-function-selection-methods-for-fixed-bandwidth" class="level2">
<h2 class="anchored" data-anchor-id="different-kernel-function-selection-methods-for-fixed-bandwidth">Different Kernel Function Selection Methods for Fixed Bandwidth</h2>
<p>The default kernel in&nbsp;<code>density.ppp()</code>&nbsp;is the&nbsp;<code>gaussian</code>. But there are other options such as&nbsp;<code>epanechnikov</code>,&nbsp;<code>quartic</code>&nbsp;or&nbsp;<code>disc.</code></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott.gaussian <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sigma=</span>fixed_bw_scott, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">edge=</span><span class="cn">TRUE</span>, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott.epanechnikov <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sigma=</span>fixed_bw_scott, </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">edge=</span><span class="cn">TRUE</span>, </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel=</span><span class="st">"epanechnikov"</span>)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott.quartic <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sigma=</span>fixed_bw_scott, </span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">edge=</span><span class="cn">TRUE</span>, </span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel=</span><span class="st">"quartic"</span>)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>kde_fixed_scott.disc <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, </span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sigma=</span>fixed_bw_scott, </span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">edge=</span><span class="cn">TRUE</span>, </span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel=</span><span class="st">"disc"</span>)</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed_bw_scott.gaussian, <span class="at">main=</span><span class="st">"Gaussian"</span>)</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed_bw_scott.epanechnikov, <span class="at">main=</span><span class="st">"Epanechnikov"</span>)</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed_bw_scott.quartic, <span class="at">main=</span><span class="st">"Quartic"</span>)</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed_scott.disc, <span class="at">main=</span><span class="st">"Disc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
</section>
<section id="kde-layers-with-spatially-adaptive-bandwidth" class="level2">
<h2 class="anchored" data-anchor-id="kde-layers-with-spatially-adaptive-bandwidth">KDE Layers with Spatially Adaptive Bandwidth</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>kde_adaptive <span class="ot">&lt;-</span> <span class="fu">adaptive.density</span>(grab_origin_ppp_sg_km, <span class="at">method=</span><span class="st">"kernel"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="comparing-fixed-bandwidth-and-adaptive" class="level1">
<h1>Comparing Fixed Bandwidth and Adaptive</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed_bw_scott.gaussian, <span class="at">main =</span> <span class="st">"Fixed bandwidth"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_adaptive, <span class="at">main =</span> <span class="st">"Adaptive bandwidth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="interactive-kde-maps" class="level2">
<h2 class="anchored" data-anchor-id="interactive-kde-maps">Interactive KDE Maps</h2>
</section>
<section id="converting-kde-output-into-grid-object-into-rasterlayer-object" class="level2">
<h2 class="anchored" data-anchor-id="converting-kde-output-into-grid-object-into-rasterlayer-object">Converting KDE output into grid object into RasterLayer object</h2>
<p>We need to convert our KDE output into Grid objects for mapping purposes</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(kde_fixed_bw_scott)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>kde_adaptive_kernel_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(kde_adaptive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s perform project transformation</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_fixed_bw_scott_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:3414 +units=km"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_adaptive_kernel_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:3414 +units=km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="kernel-density-maps-on-openstreetmap" class="level2">
<h2 class="anchored" data-anchor-id="kernel-density-maps-on-openstreetmap">Kernel Density Maps on OpenStreetMap</h2>
<p>Lets visualise our Kernel Density Maps on OpenStreetMap</p>
<p>First we create a mapping function</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>density_map <span class="ot">&lt;-</span> <span class="cf">function</span>(raster_object, map_title) {</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_basemap</span>(<span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz_sf) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#or mpsz_sf</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>, <span class="at">alpha=</span><span class="fl">0.65</span>) <span class="sc">+</span> </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.5</span>, </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.4</span>,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title =</span> map_title,</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">'center'</span>,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  } </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plotting Density Map</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott_map <span class="ot">&lt;-</span> <span class="fu">density_map</span>(kde_fixed_bw_scott_raster, <span class="at">map_title =</span> <span class="st">"Grab Origin KDE Fixed Bandwidth (Scott Method)"</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>kde_adaptive_kernel_map <span class="ot">&lt;-</span> <span class="fu">density_map</span>(kde_adaptive_kernel_raster, <span class="at">map_title =</span> <span class="st">"Grab Origin KDE Adaptive Bandwidth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott_map <span class="ot">&lt;-</span> <span class="fu">tm_basemap</span>(<span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(kde_fixed_bw_scott_raster) <span class="sc">+</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">alpha =</span> <span class="fl">0.65</span>, <span class="at">title =</span> <span class="st">"KDE_Fixed_Scott"</span>, <span class="at">palette =</span> <span class="fu">brewer.pal</span>(<span class="dv">12</span>, <span class="st">"Set3"</span>)) <span class="sc">+</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Grab Origin KDE Fixed Bandwidth (Scott Method)"</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_leaflet</span>(kde_fixed_bw_scott_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2f3395e06f921bb91910" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2f3395e06f921bb91910">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAABfCAYAAABxwvxSAAAGP0lEQVR4nO2dPW4VMRCA/VAOQJmCIhdIgVCKtNwAcQNugHIOxA24AeIGtBQRouACKShScoNQGRY//8x4xp4Zez6Jgvfy3tv1fjs7tme9p+BU+fDz21P62t317UliW5x/+AHIkJM1x9317en4ty70PJ5Jb4A2oNKWPkv5vAPHI0QCp3gegcfhDRt4Zc3hAvOzfYOWpL26f2x+9uHmEvVbLjAfF9IbIA1E0NZnsQI7dFRHgFI0pESuz5++DE0LoBJ79KWhdlShlndq7rnXIvhRVs37YAGVqULPQY2fKUUyaKR9/epl9f2v339gN80ZgKrLFVbYWgQrRb6WmBAw8rZSB08Z+lCTKvRGWe2X3PQEuru+PbmsdFSmClisyPtwc6l+W60gJq6lA8iV117dP/5NHTzq0pieKsy6vD/cXGbzS6yEszpjlk5kDUw76yUPDGWSgZO379781961NvGIXGd4xLXQgZpFOiTncvYzvOG0SKsl6np9Aw/biMtJ70lAqWlIi9bja91faJwlhsNmEwWECsxRhLNiAKDg4hpm59uGhu7sLlEijbxSZY47yTtsR3eRViM7CKymVsFxMLCfmR5pdbB61HVxFZMbtcDkzyvLu4y4WjpIXLSG2nYX2PRwWO3gHt+zJPEIYT/8/Pa0mrxmxcXMXh3LCXeCuipP7nUtJ8A2owpX949q6hVKcEZbCq0bVTX0Y7YRN6JV3tJ2xbpiqrTcskkLzJoqaDgTIWhKHTSdSFaOXwiM4lraaUkwonKfXCsdo+1ShYhEzqslusZ952gDqZPB7KiCJTQJW3pdS+oEhSyu1Bn3cHNJEmLWgdIgLWQbrI17k1IF6Zypt7dtQVoL8kjiqYJzBjZ1kLilaBtxLUQw7m2UWvt3hsjdXyidJoQw956vHiSHvjhza65t4xTY5HCYhelbKByzYqPhamvOYIc+Azh/fKZ8EnJI1R60fhey1Gpr6amebeeMuGI5rtTgv/boNhLM2sDp32pb0Hq6uKtc4ncjihwFlg4EqNBNTRNq0nKsFB4ZcZnrpVb1Nfs3W238/MXH7Ou/f73/7//H9oXsx4hRBRWdM05pId+3atQf1WktCR1/UwIV4mrLn3akJieFUZMRKsQNIS/v1+8//v6zCPSeuNG/Fam1ZZoOQJHKcUGdM64hsFZhTE3Q9L1aOmBFdG1VWVHeY/TtFXo0zTA+aoZMOs+UGkOtAdkmznbD9C3SYCD9BE0xcUOQk1eiR6+dksS5q5fUSMIR0SKbtAGsHvSI5e2HpldaUpuquLMLaTCNIrEqOOd2WEKLrEeq4VxDBRgEqSosSk2A9g7kCFk504fsF1kRNgdEYupB4ZoBlJRXIoouUWQzCsjzGbAL5HFUW7U+N1JiyUt97qErHCwnbg8r5qmcZYeUp9rXvpdCVtzjKn/cPzgL7JNxeslFW2ixCje9kRUi1vFvNDwRk61zBrkkjLps1BgpbiotZL6/JG9vqiA9ESBFtlYBs6DZ3fXtiSpk6dISv7v3e1dnV2lDIOa4rQZpCd1KSeLrlBODunBIjp5IW4Iz0q4oaIlucbnz4FqjxxW1e0UeIe8sWlF1J1mPkHqRkIR91nLurW2eUZzSk+OWIq4LW+ds57EdstZnNTRwbrs4RMamDBBpS8JqaEdNsBaSW2pcjesZlPJWS+06izNxqY10bGgNDd66gmiT94iG9tMKeabESuNC9wmTQkAnH3Jjt6U0wUp7SrPklO9R0jT6QyIwZ0dO660v1llS3COzH05HEdWjLZzmqECKlcYduXjJEWxlWJoivH33xkR7auMiBNvFND1AC0YcvaBnv6xE3AhkbLm2/9TOWgjlSQaPtv0sn+OmnbKRJx6m7sClpdFdb2At8tZIRyHS9uAcZXBhebjYPccrpRKYdkll/Pzpy1PtfYfO9hGXmkIcJc1NIMwejtuFM3F3aWSOJ8O0KuKccSzfOSuBkQsqqEfXeXjDI9Fwo6DjOS4a6q3aDg/bpgq9YGbdXNpxXISAu3/MD4ajAc9xiWi9XWl1zgbasb1tP0h7DidKQ15Zxg+UI4Gap+44DgYX1zGJi+uY5Gwc13NWxwIecR2TsK5X69HamQX6Lt8aLq4zC7an7ri0zkxAsnnBtOM4DgN/AN1k0Ac5IH/mAAAAAElFTkSuQmCC",[[1.470763207292612,103.6056793088086],[1.208696325532161,104.0858071601942]],0.6470588235294118,null,"tmap401","kde_fixed_bw_scott_raster"]},{"method":"addLegend","args":[{"colors":["#8DD3C7","#AD9EAF","#EFD1E0","#FFED6F"],"labels":["0 to 50","50 to 100","100 to 150","150 to 200"],"na_color":null,"na_label":"NA","opacity":0.6470588235294118,"position":"topright","type":"unknown","title":"KDE_Fixed_Scott","extra":null,"layerId":"legend401","className":"info legend kde_fixed_bw_scott_raster","group":"kde_fixed_bw_scott_raster"}]},{"method":"addLayersControl","args":[[],"kde_fixed_bw_scott_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.208696325532161,1.470763207292612],"lng":[103.6056793088086,104.0858071601942]},"fitBounds":[1.210235134121045,103.6056793088086,1.470763207292615,104.0844066773101,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n\t\t\t\t\t\tfunction(el, x) {\n\t\t\t\t\t\t\tvar tldiv = document.getElementsByClassName(\"leaflet-top leaflet-left\")[0];\n\t\t\t\t\t\t\tvar titlediv = document.createElement('div');\n\t\t\t\t\t\t\ttitlediv.className = \"info legend leaflet-control\";\n\t\t\t\t\t\t\ttitlediv.innerHTML = \"<b>Grab Origin KDE Fixed Bandwidth (Scott Method)<\/b>\";\n\t\t\t\t\t\t\ttldiv.insertBefore(titlediv, tldiv.childNodes[0]);\n\t\t\t\t\t\t}).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>kde_adaptive_kernel_map <span class="ot">&lt;-</span> <span class="fu">tm_basemap</span>(<span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(kde_adaptive_kernel_raster) <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">alpha =</span> <span class="fl">0.65</span>, <span class="at">title =</span> <span class="st">"KDE_Adaptive_Kernel"</span>, <span class="at">palette =</span> <span class="fu">brewer.pal</span>(<span class="dv">12</span>, <span class="st">"Set3"</span>)) <span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Grab Origin KDE Adaptive Bandwidth"</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_leaflet</span>(kde_adaptive_kernel_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a68d640b1c4feadca65f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a68d640b1c4feadca65f">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAABfCAYAAABxwvxSAAAElUlEQVR4nO2dPXIUMRCFtdRGJiLlAgSUD+AqQoi4ANEGHAGfw1cgIOICRHboKh/AdyAlgtREwoNWM6OflvS69b4qAtae9W7PN297JO3MwZFNbh4fnsLHri+vDiNeC3mGOyBCTNYY15dXh+XvUuh+vBj9AtBIlXZt25rtSTpMiABJ8ZjA7WBhnaysMSiwPNMXtOdHOwWWgz0uUQl0AqylYU1yoZw8MX3rgE3cLcFGyXe6va/afikrygGklePoFxCjZKf6bdaSjKLYAurjKlcuCwnGlqEMmFahNGVTtzvd3v/7F/tZyrYSXF9eHShrPTAF1JqYtVDiMoYVDUnU0+29+/bh3X+Pffzz1Tnn3I+Lz03+JoWto/vJGcKIQChpjFRhY9KXcPP48ESZ0+lWKKSE3UNKxpBQzK2aUOJtmhdHk7A9SJWX4m5DcQVpkdQUOA7kBAR5ZjmxEobAzFIzcRVDcRtCcfswm8RN3yyl7ctM8jZ7o5R2HDMIDLNWgZAcxI9MJi0G1lOXiQtO6co06wHCxJ0Ai+nLxDWMX/trMUzMzJz5j9MWi2O0UntVntjjKOnNxCVn7H1RFSHBTfS4rZYhWiM1LXP24agEFm0VRh2JlFYGhCRNRexoQX3TYRoznWUZlbjme1xK2pZRgWVe3BCKbIPqHhe1RSC2qUpcSktGUdVYU1wSo8cJG8UlzUdaWois/jqzRA+SAk83qkDGIRl22UcAk5aUwsQl1UhdNnUUsOJqLyw6OSdjiPsiK7pbtwlcU4vJ+18v3d2r38XbtxhVGJa44VHsh2QoLUlhmLihoLnCrn18IX6saebL6+9waescWKtA8EBsE5xLXGRDYefD30rgzdsLd/fz0+BXc87u0UBpbdJrQf2wVoHikhJaL7SBHccl+Ujejw2dzaOCaUtKaZ24FJd0Q1Lm6KgChSXosMclTek6qsDEbQP6NR3WJKu5q30r2OMOBmFh0Z5o4e1aEe6IKSZuyuUsrV7yUgMoV1mUItrj5lyRT+IarGFR/f/9c5c+7wgQx1G11TCFqguC7BVkT2i//drvbN1VEZG1HrZXO2BR0DWKxd2TrvT5YvgeS4vIPfvWmWRdUnUWmdKwLwVvWWQkkdfElRxVmFVYz9mbr7mob2xbhAIjSV0KQh2REJ2AYHHl0XiC2gOxViH2HAgF15y2CPVDpXqmREtxtdybQks9R2PmdlFLlpIux4TDn7UCYTbMOuYX2fRM2qWwXtqcCQmmbTq7owIhWoqL2NvGWgct9UTj6BzmTm5J6oIRadg6yGG2VUgdRhqZeEzbcsyK6wkFRpEF5XVopfhM21Lhw1GIlu2DpbqN5DhbfxuyNk0tOfVNWeWZPnGXK85qtvfEJLZSKyTOxJ2lyBKpuLcijrTD5MxZCjlypQrKdO0HC58JwhcFCXvcbBC/qj0j07YKpeTMulHadhydy1s5xZ1BEGCPWwnq15WsczbQnnu2zZ0053DiaKqnN7mjyAjML7IhNqG4RCUUl6jkbByXPSvRABOXqER00TTTmvQi+1u+W1Bc0guxe0BQWtKTJNm4YJoQQgT4C34Sq7ktAx9tAAAAAElFTkSuQmCC",[[1.470763207292612,103.6056793088086],[1.208696325532161,104.0858071601942]],0.6470588235294118,null,"tmap401","kde_adaptive_kernel_raster"]},{"method":"addLegend","args":[{"colors":["#8DD3C7","#EB8E8B","#D8C965","#D1C2D2","#FFED6F"],"labels":["0 to 500","500 to 1,000","1,000 to 1,500","1,500 to 2,000","2,000 to 2,500"],"na_color":null,"na_label":"NA","opacity":0.6470588235294118,"position":"topright","type":"unknown","title":"KDE_Adaptive_Kernel","extra":null,"layerId":"legend401","className":"info legend kde_adaptive_kernel_raster","group":"kde_adaptive_kernel_raster"}]},{"method":"addLayersControl","args":[[],"kde_adaptive_kernel_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.208696325532161,1.470763207292612],"lng":[103.6056793088086,104.0858071601942]},"fitBounds":[1.210235134121045,103.6056793088086,1.470763207292615,104.0844066773101,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n\t\t\t\t\t\tfunction(el, x) {\n\t\t\t\t\t\t\tvar tldiv = document.getElementsByClassName(\"leaflet-top leaflet-left\")[0];\n\t\t\t\t\t\t\tvar titlediv = document.createElement('div');\n\t\t\t\t\t\t\ttitlediv.className = \"info legend leaflet-control\";\n\t\t\t\t\t\t\ttitlediv.innerHTML = \"<b>Grab Origin KDE Adaptive Bandwidth<\/b>\";\n\t\t\t\t\t\t\ttldiv.insertBefore(titlediv, tldiv.childNodes[0]);\n\t\t\t\t\t\t}).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
</section>
<section id="kernel-density-map-analysis" class="level2">
<h2 class="anchored" data-anchor-id="kernel-density-map-analysis">Kernel Density Map Analysis</h2>
</section>
<section id="comparing-spatial-point-patterns-using-kde" class="level2">
<h2 class="anchored" data-anchor-id="comparing-spatial-point-patterns-using-kde"><strong>Comparing Spatial Point Patterns using KDE</strong></h2>
</section>
<section id="extract-planning-areas" class="level2">
<h2 class="anchored" data-anchor-id="extract-planning-areas">Extract Planning Areas</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>je <span class="ot">=</span> mpsz_sf<span class="sc">%&gt;%</span><span class="fu">filter</span>(PLN_AREA_N <span class="sc">==</span> <span class="st">"JURONG EAST"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>tm <span class="ot">=</span> mpsz_sf<span class="sc">%&gt;%</span><span class="fu">filter</span>(PLN_AREA_N <span class="sc">==</span> <span class="st">"TAMPINES"</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>ck <span class="ot">=</span> mpsz_sf<span class="sc">%&gt;%</span><span class="fu">filter</span>(PLN_AREA_N <span class="sc">==</span> <span class="st">"CHOA CHU KANG"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>jw <span class="ot">=</span> mpsz_sf<span class="sc">%&gt;%</span><span class="fu">filter</span>(PLN_AREA_N <span class="sc">==</span> <span class="st">"JURONG WEST"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plotting-target-planning-areas" class="level2">
<h2 class="anchored" data-anchor-id="plotting-target-planning-areas">Plotting target planning areas</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(je), <span class="at">main =</span> <span class="st">"Jurong East"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(tm), <span class="at">main =</span> <span class="st">"Tampines"</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(ck), <span class="at">main =</span> <span class="st">"Choa Chu Kang"</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(jw), <span class="at">main =</span> <span class="st">"Jurong West"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>je_owin <span class="ot">=</span> <span class="fu">as.owin</span>(je)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>tm_owin <span class="ot">=</span> <span class="fu">as.owin</span>(tm)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>ck_owin <span class="ot">=</span> <span class="fu">as.owin</span>(ck)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>jw_owin <span class="ot">=</span> <span class="fu">as.owin</span>(jw)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>origin_je_ppp <span class="ot">=</span> grab_origin_ppp_sg[je_owin]</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>origin_tm_ppp <span class="ot">=</span> grab_origin_ppp_sg[tm_owin]</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>origin_ck_ppp <span class="ot">=</span> grab_origin_ppp_sg[ck_owin]</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>origin_jw_ppp <span class="ot">=</span> grab_origin_ppp_sg[jw_owin]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>je_kde_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(origin_je_ppp, <span class="at">sigma=</span>bw.scott, <span class="at">main=</span><span class="st">"Jurong East"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>tm_kde_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(origin_tm_ppp, <span class="at">sigma=</span>bw.scott, <span class="at">main=</span><span class="st">"Tampines"</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>ck_kde_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(origin_ck_ppp, <span class="at">sigma=</span>bw.scott, <span class="at">main=</span><span class="st">"Choa Chu Kang"</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>jw_kde_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(origin_jw_ppp, <span class="at">sigma=</span>bw.scott, <span class="at">main=</span><span class="st">"Jurong West"</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(je_kde_scott,<span class="at">main =</span> <span class="st">"KDE Jurong East"</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tm_kde_scott,<span class="at">main =</span> <span class="st">"KDE Tampines"</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ck_kde_scott,<span class="at">main =</span> <span class="st">"KDE Choa Chu Kang"</span>)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(jw_kde_scott,<span class="at">main =</span> <span class="st">"Jurong West"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="nearest-neighbour-analysis" class="level2">
<h2 class="anchored" data-anchor-id="nearest-neighbour-analysis">Nearest Neighbour Analysis</h2>
</section>
<section id="clark-evans-test-of-aggregation" class="level2">
<h2 class="anchored" data-anchor-id="clark-evans-test-of-aggregation">Clark-Evans test of aggregation</h2>
</section>
<section id="origin-points" class="level2">
<h2 class="anchored" data-anchor-id="origin-points">Origin Points</h2>
<p>The test hypotheses are:</p>
<ul>
<li><p>H<sub>0</sub> = The distribution of origin points are randomly distributed</p></li>
<li><p>H<sub>1</sub>= The distribution of origin points are not randomly distributed</p></li>
</ul>
<p>The 95% confident interval will be used.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(grab_origin_ppp_sg,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="st">"sg_owin"</span>,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>),</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Clark-Evans test
    No edge correction
    Z-test

data:  grab_origin_ppp_sg
R = 0.27978, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)</code></pre>
</div>
</div>
</section>
<section id="destination-points" class="level2">
<h2 class="anchored" data-anchor-id="destination-points">Destination Points</h2>
<p>The test hypotheses are:</p>
<ul>
<li><p>H<sub>0</sub> = The distribution of destination points are randomly distributed</p></li>
<li><p>H<sub>1</sub>= The distribution of destination points are not randomly distributed</p></li>
</ul>
<p>The 95% confidence interval will be used.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(grab_dest_ppp_sg,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="st">"sg_owin"</span>,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>),</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Clark-Evans test
    No edge correction
    Z-test

data:  grab_dest_ppp_sg
R = 0.30057, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)</code></pre>
</div>
</div>
</section>
<section id="network-constrained-kernel-density-estimation-nkde" class="level2">
<h2 class="anchored" data-anchor-id="network-constrained-kernel-density-estimation-nkde"><strong>Network Constrained Kernel Density Estimation (NKDE)</strong></h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>