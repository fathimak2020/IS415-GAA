<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-02-13">

<title>IS415 - GAA - Take-home Exercise 1: Application of Spatial Point Patterns Analysis to Discover the Geographical Distribution of Grab Hailing Services in Singapore [DATA PREPARATION]</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415 - GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex3.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03-NKDE.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01a.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1a: Data Preparation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01b.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1b: Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02a.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2a: Data Preparation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02b.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2b: Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About Me!</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1 Overview</a></li>
  <li><a href="#setting-the-scene" id="toc-setting-the-scene" class="nav-link" data-scroll-target="#setting-the-scene">1.1 Setting the scene</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.2 Objectives</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">2 Getting Started</a></li>
  <li><a href="#data-acquisition" id="toc-data-acquisition" class="nav-link" data-scroll-target="#data-acquisition">2.1 Data Acquisition</a></li>
  <li><a href="#importing-relevant-r-packages" id="toc-importing-relevant-r-packages" class="nav-link" data-scroll-target="#importing-relevant-r-packages"><strong>2.2 Importing Relevant R Packages</strong></a></li>
  <li><a href="#importing-geospatial-datasets" id="toc-importing-geospatial-datasets" class="nav-link" data-scroll-target="#importing-geospatial-datasets">2.3 Importing Geospatial Datasets</a>
  <ul class="collapse">
  <li><a href="#master-plan-2019-subzone-boundary-no-sea" id="toc-master-plan-2019-subzone-boundary-no-sea" class="nav-link" data-scroll-target="#master-plan-2019-subzone-boundary-no-sea">2.3.1 Master Plan 2019 Subzone Boundary (No Sea)</a></li>
  <li><a href="#coastal-outline" id="toc-coastal-outline" class="nav-link" data-scroll-target="#coastal-outline">2.3.2 Coastal Outline</a></li>
  <li><a href="#extracting-outer-islands" id="toc-extracting-outer-islands" class="nav-link" data-scroll-target="#extracting-outer-islands">2.3.2.1 Extracting Outer Islands</a></li>
  <li><a href="#rendering-a-coastal-boundary-excluding-outer-islands" id="toc-rendering-a-coastal-boundary-excluding-outer-islands" class="nav-link" data-scroll-target="#rendering-a-coastal-boundary-excluding-outer-islands">2.3.2.2 Rendering a Coastal Boundary Excluding Outer Islands</a></li>
  <li><a href="#open-street-map-road-data" id="toc-open-street-map-road-data" class="nav-link" data-scroll-target="#open-street-map-road-data">2.3.3 Open Street Map Road Data</a></li>
  </ul></li>
  <li><a href="#importing-aspatial-datasets" id="toc-importing-aspatial-datasets" class="nav-link" data-scroll-target="#importing-aspatial-datasets">2.4 Importing Aspatial Datasets</a>
  <ul class="collapse">
  <li><a href="#grab-posisi" id="toc-grab-posisi" class="nav-link" data-scroll-target="#grab-posisi">2.4.1 Grab-Posisi</a></li>
  <li><a href="#converting-aspatial-data-frame-into-a-simple-feature-data-frame" id="toc-converting-aspatial-data-frame-into-a-simple-feature-data-frame" class="nav-link" data-scroll-target="#converting-aspatial-data-frame-into-a-simple-feature-data-frame">2.4.1.2 Converting Aspatial Data Frame into a Simple Feature Data Frame</a></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">2.5 Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#extracting-grab-trips-starting-locations" id="toc-extracting-grab-trips-starting-locations" class="nav-link" data-scroll-target="#extracting-grab-trips-starting-locations">2.5.1 <strong>Extracting Grab Trips Starting Locations</strong></a></li>
  <li><a href="#extracting-grab-trips-ending-locations" id="toc-extracting-grab-trips-ending-locations" class="nav-link" data-scroll-target="#extracting-grab-trips-ending-locations">2.5.2 <strong>Extracting Grab Trips Ending Locations</strong></a></li>
  <li><a href="#converting-simple-features-to-planar-point-pattern-objects" id="toc-converting-simple-features-to-planar-point-pattern-objects" class="nav-link" data-scroll-target="#converting-simple-features-to-planar-point-pattern-objects">2.5.3 Converting Simple Features to Planar Point Pattern Objects</a></li>
  <li><a href="#check-for-duplicates-and-handle-data-errors" id="toc-check-for-duplicates-and-handle-data-errors" class="nav-link" data-scroll-target="#check-for-duplicates-and-handle-data-errors">2.5.4 Check for Duplicates and Handle Data Errors</a></li>
  <li><a href="#introducing-owin" id="toc-introducing-owin" class="nav-link" data-scroll-target="#introducing-owin">2.5.5 Introducing OWIN</a></li>
  <li><a href="#creating-owin-object" id="toc-creating-owin-object" class="nav-link" data-scroll-target="#creating-owin-object">2.5.5.1 Creating OWIN Object</a></li>
  <li><a href="#combining-point-events-and-owin-object" id="toc-combining-point-events-and-owin-object" class="nav-link" data-scroll-target="#combining-point-events-and-owin-object">2.5.5.2 Combining Point Events and OWIN Object</a></li>
  <li><a href="#origin-points-in-owin-object" id="toc-origin-points-in-owin-object" class="nav-link" data-scroll-target="#origin-points-in-owin-object">2.5.5.2.1 Origin Points in OWIN Object</a></li>
  <li><a href="#destination-points-in-owin-object" id="toc-destination-points-in-owin-object" class="nav-link" data-scroll-target="#destination-points-in-owin-object">2.5.5.2.1 Destination Points in OWIN Object</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">3.0 Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#spatial-relationship-between-origin-and-destination-points" id="toc-spatial-relationship-between-origin-and-destination-points" class="nav-link" data-scroll-target="#spatial-relationship-between-origin-and-destination-points">3.1 Spatial Relationship between Origin and Destination Points</a></li>
  <li><a href="#spatio-temporal-visualisations" id="toc-spatio-temporal-visualisations" class="nav-link" data-scroll-target="#spatio-temporal-visualisations">3.2 Spatio-Temporal Visualisations</a></li>
  <li><a href="#frequency-of-trip-by-hour" id="toc-frequency-of-trip-by-hour" class="nav-link" data-scroll-target="#frequency-of-trip-by-hour">3.2.1 Frequency of Trip by Hour</a></li>
  <li><a href="#origin-or-pickup-frequency" id="toc-origin-or-pickup-frequency" class="nav-link" data-scroll-target="#origin-or-pickup-frequency">3.2.1.1 Origin or Pickup Frequency</a></li>
  <li><a href="#destination-or-drop-off-frequency" id="toc-destination-or-drop-off-frequency" class="nav-link" data-scroll-target="#destination-or-drop-off-frequency">3.2.1.2 Destination or Drop-off Frequency</a></li>
  <li><a href="#frequency-of-trip-by-day-of-week" id="toc-frequency-of-trip-by-day-of-week" class="nav-link" data-scroll-target="#frequency-of-trip-by-day-of-week">3.2.2 Frequency of Trip by Day of Week</a></li>
  <li><a href="#origin-or-pickup-frequency-by-days" id="toc-origin-or-pickup-frequency-by-days" class="nav-link" data-scroll-target="#origin-or-pickup-frequency-by-days">3.2.2.1 Origin or Pickup Frequency by Days</a></li>
  <li><a href="#destination-or-drop-off-frequency-by-days" id="toc-destination-or-drop-off-frequency-by-days" class="nav-link" data-scroll-target="#destination-or-drop-off-frequency-by-days">3.2.2.2 Destination or Drop-off Frequency by Days</a></li>
  </ul></li>
  <li><a href="#first-order-spatial-point-patterns-analysis" id="toc-first-order-spatial-point-patterns-analysis" class="nav-link" data-scroll-target="#first-order-spatial-point-patterns-analysis"><strong>4.0 First-Order Spatial Point Patterns Analysis</strong></a>
  <ul class="collapse">
  <li><a href="#rescale-grab_original_ppp_sg-and-grab_dest_ppp_sg" id="toc-rescale-grab_original_ppp_sg-and-grab_dest_ppp_sg" class="nav-link" data-scroll-target="#rescale-grab_original_ppp_sg-and-grab_dest_ppp_sg"><strong>4.1</strong> Rescale <code>grab_original_ppp_sg</code> and <code>grab_dest_ppp_sg</code></a></li>
  <li><a href="#kernel-density-estimation" id="toc-kernel-density-estimation" class="nav-link" data-scroll-target="#kernel-density-estimation">4.2 Kernel Density Estimation</a></li>
  <li><a href="#automatic-bandwidth-method" id="toc-automatic-bandwidth-method" class="nav-link" data-scroll-target="#automatic-bandwidth-method">4.2.1 Automatic bandwidth method</a></li>
  <li><a href="#other-bandwidth-selection-methods" id="toc-other-bandwidth-selection-methods" class="nav-link" data-scroll-target="#other-bandwidth-selection-methods">4.2.1.1 Other Bandwidth Selection Methods</a></li>
  <li><a href="#choosing-the-most-appropriate-kde-selection-method" id="toc-choosing-the-most-appropriate-kde-selection-method" class="nav-link" data-scroll-target="#choosing-the-most-appropriate-kde-selection-method">4.2.1.2 Choosing the Most Appropriate KDE Selection Method</a></li>
  <li><a href="#fixed-bandwidth-selection" id="toc-fixed-bandwidth-selection" class="nav-link" data-scroll-target="#fixed-bandwidth-selection">4.2.2 Fixed Bandwidth Selection</a></li>
  <li><a href="#different-kernel-function-selection-methods-for-fixed-bandwidth" id="toc-different-kernel-function-selection-methods-for-fixed-bandwidth" class="nav-link" data-scroll-target="#different-kernel-function-selection-methods-for-fixed-bandwidth">4.2.3 Different Kernel Function Selection Methods for Fixed Bandwidth</a></li>
  <li><a href="#kde-layers-with-spatially-adaptive-bandwidth" id="toc-kde-layers-with-spatially-adaptive-bandwidth" class="nav-link" data-scroll-target="#kde-layers-with-spatially-adaptive-bandwidth">4.2.3 KDE Layers with Spatially Adaptive Bandwidth</a></li>
  <li><a href="#comparing-fixed-and-adaptive-bandwidth" id="toc-comparing-fixed-and-adaptive-bandwidth" class="nav-link" data-scroll-target="#comparing-fixed-and-adaptive-bandwidth">4.2.4 Comparing Fixed and Adaptive Bandwidth</a></li>
  <li><a href="#interactive-kde-maps" id="toc-interactive-kde-maps" class="nav-link" data-scroll-target="#interactive-kde-maps">4.2.5 Interactive KDE Maps</a></li>
  <li><a href="#converting-kde-output-into-grid-object-into-rasterlayer-object" id="toc-converting-kde-output-into-grid-object-into-rasterlayer-object" class="nav-link" data-scroll-target="#converting-kde-output-into-grid-object-into-rasterlayer-object">4.2.5.1 Converting KDE Output into Grid Object into RasterLayer Object</a></li>
  <li><a href="#kernel-density-maps-on-openstreetmap" id="toc-kernel-density-maps-on-openstreetmap" class="nav-link" data-scroll-target="#kernel-density-maps-on-openstreetmap">4.2.5.2 Kernel Density Maps on OpenStreetMap</a></li>
  <li><a href="#kernel-density-map-analysis" id="toc-kernel-density-map-analysis" class="nav-link" data-scroll-target="#kernel-density-map-analysis">4.2.6 Kernel Density Map Analysis</a></li>
  <li><a href="#extract-planning-areas" id="toc-extract-planning-areas" class="nav-link" data-scroll-target="#extract-planning-areas">4.2.7 Extract Planning Areas</a></li>
  <li><a href="#plotting-target-planning-areas" id="toc-plotting-target-planning-areas" class="nav-link" data-scroll-target="#plotting-target-planning-areas">4.2.7.1 Plotting Target Planning Areas</a></li>
  <li><a href="#nearest-neighbour-analysis" id="toc-nearest-neighbour-analysis" class="nav-link" data-scroll-target="#nearest-neighbour-analysis">4.2.8 Nearest Neighbour Analysis</a></li>
  <li><a href="#clark-evans-test-of-aggregation" id="toc-clark-evans-test-of-aggregation" class="nav-link" data-scroll-target="#clark-evans-test-of-aggregation">4.2.8.1 Clark-Evans Test of Aggregation</a></li>
  <li><a href="#origin-points-in-jurong-east" id="toc-origin-points-in-jurong-east" class="nav-link" data-scroll-target="#origin-points-in-jurong-east">4.2.8.1.1 Origin Points in Jurong East</a></li>
  <li><a href="#origin-points-in-tampines" id="toc-origin-points-in-tampines" class="nav-link" data-scroll-target="#origin-points-in-tampines">4.2.8.1.2 Origin Points in Tampines</a></li>
  <li><a href="#origin-points-in-choa-chu-kang" id="toc-origin-points-in-choa-chu-kang" class="nav-link" data-scroll-target="#origin-points-in-choa-chu-kang">4.2.8.1.3 Origin Points in Choa Chu Kang</a></li>
  <li><a href="#origin-points-in-woodlands" id="toc-origin-points-in-woodlands" class="nav-link" data-scroll-target="#origin-points-in-woodlands">4.2.8.1.4 Origin Points in Woodlands</a></li>
  </ul></li>
  <li><a href="#network-constrained-kernel-density-estimation-nkde" id="toc-network-constrained-kernel-density-estimation-nkde" class="nav-link" data-scroll-target="#network-constrained-kernel-density-estimation-nkde"><strong>5.0 Network Constrained Kernel Density Estimation (NKDE)</strong></a></li>
  <li><a href="#extract-origin-points-and-road-network-of-our-study-areas" id="toc-extract-origin-points-and-road-network-of-our-study-areas" class="nav-link" data-scroll-target="#extract-origin-points-and-road-network-of-our-study-areas">5.1 Extract origin points and road network of our study areas</a></li>
  <li><a href="#lixels" id="toc-lixels" class="nav-link" data-scroll-target="#lixels">5.2 Lixels</a></li>
  <li><a href="#line-center" id="toc-line-center" class="nav-link" data-scroll-target="#line-center">5.3 Line Center</a></li>
  <li><a href="#using-simple-method-to-compute-nkde" id="toc-using-simple-method-to-compute-nkde" class="nav-link" data-scroll-target="#using-simple-method-to-compute-nkde">5.4 Using Simple Method to Compute NKDE</a></li>
  <li><a href="#plotting-maps-for-different-study-areas" id="toc-plotting-maps-for-different-study-areas" class="nav-link" data-scroll-target="#plotting-maps-for-different-study-areas">5.5 Plotting Maps for Different Study Areas</a>
  <ul class="collapse">
  <li><a href="#jurong-east" id="toc-jurong-east" class="nav-link" data-scroll-target="#jurong-east">5.5.1 Jurong East</a></li>
  <li><a href="#tampines" id="toc-tampines" class="nav-link" data-scroll-target="#tampines">5.5.2 Tampines</a></li>
  <li><a href="#choa-chu-kang" id="toc-choa-chu-kang" class="nav-link" data-scroll-target="#choa-chu-kang">5.5.3 Choa Chu Kang</a></li>
  <li><a href="#woodlands" id="toc-woodlands" class="nav-link" data-scroll-target="#woodlands">5.5.4 Woodlands</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">6.0 Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">7.0 References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 1: Application of Spatial Point Patterns Analysis to Discover the Geographical Distribution of Grab Hailing Services in Singapore [DATA PREPARATION]</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 13, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">1 Overview</h2>
</section>
<section id="setting-the-scene" class="level2">
<h2 class="anchored" data-anchor-id="setting-the-scene">1.1 Setting the scene</h2>
<p>Understanding how people move around in a city is like figuring out its heartbeat—it shows us the rhythms that shape our urban lives. Thanks to smartphones and technology, we now have a bunch of data about how people move. When we use smart analysis tools like GIS, we can unlock valuable insights that help us plan cities better.</p>
<p>In 2020, GRAB shared a set of data called Grab Posisi, all about how people move around in Singapore. This kind of information isn’t just interesting; it’s super helpful for businesses, people who make decisions about the city, and those who plan how cities work. It’s like having a dynamic picture of how people move, helping us create cities that work well for everyone.</p>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">1.2 Objectives</h2>
<p>The objectives of this take-home exercise are to:</p>
<ul>
<li><p>Apply geospatial analytics to address societal challenges</p></li>
<li><p>Use spatial point patterns analysis methods to explore Grab hailing services distribution in Singapore</p></li>
<li><p>Organise geospatial data into sf tibble data.frames using <code>sf</code> and <code>tidyverse</code> functions</p></li>
<li><p>Focus on Grab taxi location points, road layer within Singapore, and Singapore coastal boundary layer</p></li>
<li><p>Generate traditional Kernel Density Estimation layers</p></li>
<li><p>Create Network Kernel Density Estimation (NKDE)</p></li>
<li><p>Utilise <code>tmap</code> functions to display kernel density layers on OSM</p></li>
<li><p>Describe spatial patterns revealed by the kernel density maps</p></li>
</ul>
<p>By this exercise, I will:</p>
<ul>
<li><p>Enhance my understanding of geospatial analytics applications</p></li>
<li><p>Develop proficiency in spatial point patterns analysis</p></li>
<li><p>Gain hands-on experience in dealing with geospatial data</p></li>
<li><p>Explore Grab hailing services distribution patterns in Singapore</p></li>
<li><p>Generate and interpret Kernel Density Estimation layers</p></li>
<li><p>Understand the nuances of Network Kernel Density Estimation (NKDE)</p></li>
<li><p>Learn about the visualisation of spatial patterns using <code>tmap</code> functions on OSM</p></li>
</ul>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">2 Getting Started</h2>
</section>
<section id="data-acquisition" class="level2">
<h2 class="anchored" data-anchor-id="data-acquisition">2.1 Data Acquisition</h2>
<p>The study will utilise the following datasets to explore spatial point patterns analysis methods and reveal the geographical and spatio-temporal distribution of Grab hailing services locations in Singapore.</p>
<table class="table">
<thead>
<tr class="header">
<th>Dataset Name</th>
<th>Type</th>
<th>Source</th>
<th>Path</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Grab-Posisi</td>
<td>Aspatial (.parquet)</td>
<td><a href="https://engineering.grab.com/grab-posisi" class="uri">https://engineering.grab.com/grab-posisi</a></td>
<td>data/aspatial/grabPosisi</td>
</tr>
<tr class="even">
<td>Master Plan 2019 Subzone Boundary (No Sea)</td>
<td>Geospatial (.shp)</td>
<td><a href="https://beta.data.gov.sg/collections/2104/view" class="uri">https://beta.data.gov.sg/collections/2104/view</a></td>
<td>data/geospatial/MPSZ-2019</td>
</tr>
<tr class="odd">
<td>Open Street Map Road Data</td>
<td>Geospatial (.shp)</td>
<td><a href="https://download.geofabrik.de/asia/malaysia-singapore-brunei.html" class="uri">https://download.geofabrik.de/asia/malaysia-singapore-brunei.html</a></td>
<td>data/geospatial/OSM/gis_osm_roads_free_1</td>
</tr>
</tbody>
</table>
</section>
<section id="importing-relevant-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="importing-relevant-r-packages"><strong>2.2 Importing Relevant R Packages</strong></h2>
<p>The R packages used in this project are:</p>
<ol type="1">
<li><p><code>arrow</code>: for reading and writing Parquet files</p></li>
<li><p><code>dplyr</code>: for data manipulation</p></li>
<li><p><code>lubridate</code>: for working with date-time data</p></li>
<li><p><code>maptools</code>: set of tools for reading and manipulating spatial data formats, such as shapefiles</p></li>
<li><p><code>raster</code>: reads, writes, manipulates, analyses, and models gridded spatial data</p></li>
<li><p><code>rgdal</code>: from CRAN, enables users to import, export, and manipulate spatial data within the R environment</p></li>
<li><p><code>RcolorBrewer</code>: package providing color schemes for maps and other visualizations</p></li>
<li><p><code>rmapshaper</code>: a package for simplifying and modifying geographic shapes in R</p></li>
<li><p><code>sf</code>: for importing, managing, and processing geospatial data</p></li>
<li><p><code>spNetwork</code>: to perform spatial analysis for NKDE</p></li>
<li><p><code>spatstat</code>: for performing spatial point patterns analysis</p></li>
<li><p><code>tidyverse</code>: a family of other R packages for performing data science tasks such as importing, wrangling, and visualizing data</p></li>
<li><p><code>tmap</code>: creating static and interactive maps</p></li>
<li><p><code>ggplot2</code>: used for data visualization</p></li>
<li><p><code>plotly</code>: interactive graphing library for R</p></li>
</ol>
<p>Pacman assists us by helping us load R packages that we require.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a> pacman<span class="sc">::</span><span class="fu">p_load</span>(arrow, dplyr, lubridate, maptools, raster, rgdal, RColorBrewer, rmapshaper, sf, sp, spNetwork, spatstat, tidyverse, tmap, ggplot2, plotly)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#update.packages(ask = FALSE, dependencies = TRUE)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages("maptools", repos = "https://packagemanager.posit.co/cran/2023-10-13")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-geospatial-datasets" class="level2">
<h2 class="anchored" data-anchor-id="importing-geospatial-datasets">2.3 Importing Geospatial Datasets</h2>
<section id="master-plan-2019-subzone-boundary-no-sea" class="level3">
<h3 class="anchored" data-anchor-id="master-plan-2019-subzone-boundary-no-sea">2.3.1 Master Plan 2019 Subzone Boundary (No Sea)</h3>
<p>For shapefile format, two arguments are required:&nbsp;<code>dsn</code>&nbsp;to define the data path, and&nbsp;<code>layer</code>&nbsp;to provide the shapefile name.&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mpsz_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"MPSZ-2019"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Project Transformation</strong></p>
<p>Given that our dataset corresponds to the geographical boundaries of Singapore, it is necessary to specify the appropriate CRS for accurate spatial analysis. To achieve this, the <strong><code>st_transform()</code></strong> function is used to convert the CRS of <code>mpsz_sf</code> to SVY21 (EPSG: 3414)</p>
</div>
</div>
</section>
<section id="coastal-outline" class="level3">
<h3 class="anchored" data-anchor-id="coastal-outline">2.3.2 Coastal Outline</h3>
<p>In order to create a costal outline of singapore, we will use the <code>st_union</code> function to consolidate all subzone boundaries from <code>mpsz_sf</code> into a single polygon.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>outline <span class="ot">=</span> mpsz_sf <span class="sc">%&gt;%</span> <span class="fu">st_union</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(outline)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extracting-outer-islands" class="level3">
<h3 class="anchored" data-anchor-id="extracting-outer-islands">2.3.2.1 Extracting Outer Islands</h3>
<p>As seen in the figure above, the coastal outline includes outer islands where Grab service is unavailable. Through the code chunk below, we use the <code>subset</code> function to select subzones from the <code>mpsz_sf</code> dataset to exclude. These excluded rows of data are stored in new dataframes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>semakau <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf,mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span> <span class="st">"SEMAKAU"</span>) <span class="co">#western island</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sudong <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf, mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span> <span class="st">"SUDONG"</span>) <span class="co">#western island</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>bukom <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf, mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span>  <span class="st">"JURONG ISLAND AND BUKOM"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>north <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf, mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span> <span class="st">"NORTH-EASTERN ISLANDS"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>south <span class="ot">&lt;-</span> <span class="fu">subset</span>(mpsz_sf, mpsz_sf<span class="sc">$</span>SUBZONE_N <span class="sc">==</span> <span class="st">"SOUTHERN GROUP"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We combine the newly created dataframes using the <code>bind_rows</code> function and store the data in another dataframe called <code>outer</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>outer <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(<span class="fu">list</span>(semakau,sudong,bukom,north,south))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rendering-a-coastal-boundary-excluding-outer-islands" class="level3">
<h3 class="anchored" data-anchor-id="rendering-a-coastal-boundary-excluding-outer-islands">2.3.2.2 Rendering a Coastal Boundary Excluding Outer Islands</h3>
<p>We use the <code>st_union</code> function again to merge the geometries of <code>mpsz_sf</code> and <code>outer</code>, and the <code>st_difference</code> function to eliminate the overlap between the two layers. This results in a coastal boundary, <code>sg_sf</code>, which excludes the outer islands.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sg_sf <span class="ot">&lt;-</span> <span class="fu">st_difference</span>(<span class="fu">st_union</span>(mpsz_sf), <span class="fu">st_union</span>(outer))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sg_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>✅ Task Complete! We have obtained the coastal boundary layer of Singapore, excluding the outer islands.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(sg_sf, "data/rds/sg_sf.rds")</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sg_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/sg_sf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="open-street-map-road-data" class="level3">
<h3 class="anchored" data-anchor-id="open-street-map-road-data">2.3.3 Open Street Map Road Data</h3>
<p>Let’s import the road data obtained from OSM.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>allroads <span class="ot">=</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/OSM"</span>, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">layer =</span> <span class="st">"gis_osm_roads_free_1"</span>)  <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Project Transformation</strong></p>
<p>Given that our dataset corresponds to the geographical boundaries of Singapore, it’s necessary to specify the appropriate CRS for accurate spatial analysis. To achieve this, the <strong><code>st_transform()</code></strong> function is used to convert the CRS of <code>allroads</code> to SVY21 (EPSG: 3414)</p>
</div>
</div>
<p>This dataset encompasses road networks spanning Singapore, Malaysia, and Brunei. To narrow our focus, we will extract roads exclusively within the Singapore boundary using the <code>st_intersection</code> function to check the intersection between <code>sg_sf</code> and <code>allroads</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sg_roads_all <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(allroads,sg_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(sg_roads_all, "data/rds/sg_roads_all.rds")</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sg_roads_all <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/sg_roads_all.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The next step involves examining the various road types within the road network.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(sg_roads_all<span class="sc">$</span>fclass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Given our focus on Grab services, which primarily operate on roads excluding expressways (it is not possible for Grab to pick-up or drop off passengers along expressways), we will extract the relevant road types from the road network. To determine which roads are applicable, we can look at the OSM fclass. The image below provides descriptions for each road type, and for our analysis, we will focus on the most relevant types: primary, residential, tertiary, service, secondary, primary_link, secondary_link, and tertiary_link</p>
<p><img src="images/Screenshot 2024-02-01 122342.png" class="img-fluid" width="425"></p>
<p>We store the selected road types in a dataframe called <code>sg_roads_filtered</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sg_roads_filtered <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"primary"</span>, <span class="st">"residential"</span>, <span class="st">"tertiary"</span>, <span class="st">"service"</span>, <span class="st">"secondary"</span>, <span class="st">"primary_link"</span>, <span class="st">"secondary_link"</span>, <span class="st">"tertiary_link"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sg_roads <span class="ot">&lt;-</span> sg_roads_all[sg_roads_all<span class="sc">$</span>fclass <span class="sc">%in%</span> sg_roads_filtered, ]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(sg_roads<span class="sc">$</span>fclass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will now visualise the selected road types within the boundaries of Singapore using <code>tmap</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>road_type_palette <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">12</span>, <span class="st">"Set3"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(sg_sf) <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">'grey'</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(sg_roads) <span class="sc">+</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"fclass"</span>, <span class="at">palette =</span> road_type_palette)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">main.title =</span> <span class="st">"Types of Road Networks in Singapore"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>✅ Task Complete! We have extracted the road layer within Singapore.</p>
</div>
</div>
</section>
</section>
<section id="importing-aspatial-datasets" class="level2">
<h2 class="anchored" data-anchor-id="importing-aspatial-datasets">2.4 Importing Aspatial Datasets</h2>
<section id="grab-posisi" class="level3">
<h3 class="anchored" data-anchor-id="grab-posisi">2.4.1 Grab-Posisi</h3>
<p>Grab-Posisi, is a GPS trajectory dataset. Each trajectory is serialised in a file in Apache Parquet format.</p>
<p>We will use the <code>read_parquet</code> function from the <code>arrow</code> package, to read Parquet files.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>grab0 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00000.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>grab1 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00001.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>grab2 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00002.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>grab3 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00003.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>grab4 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00004.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>grab5 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00005.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>grab6 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00006.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>grab7 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00007.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>grab8 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00008.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>grab9 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/aspatial/GrabPosisi/part-00009.parquet"</span>, <span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we join all the read files into one dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>grab <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(grab0,grab1, grab2,grab3,grab4,grab5,grab6,grab7,grab8,grab9) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(grab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>head</code> function reveals that there are 9 columns in the dataframe.</p>
<p>The field <code>pingtimestamp</code> is not in proper date-time format. It is stored as an <code>int</code> value. The following code chunk converts the data type of <code>pingtimestamp</code> from <code>int</code> to <code>date-time</code> format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>grab<span class="sc">$</span>pingtimestamp <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(grab<span class="sc">$</span>pingtimestamp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="converting-aspatial-data-frame-into-a-simple-feature-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="converting-aspatial-data-frame-into-a-simple-feature-data-frame">2.4.1.2 Converting Aspatial Data Frame into a Simple Feature Data Frame</h3>
<p>We will proceed to convert the <code>grab</code> dataset, currently in an aspatial data frame, into an sf tibble dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>grab_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(grab, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"rawlng"</span>, <span class="st">"rawlat"</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write_rds(grab_sf, "data/rds/grab_sf.rds")</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>grab_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_sf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Project Transformation</strong></p>
<p>Assuming the dataset is initially in the WGS84 Geographic Coordinate System, as indicated by the latitude/longitude fields, we need to define the suitable CRS for spatial analysis within Singapore. The <code>st_transform()</code> function is utilised to convert the CRS of the <code>grab</code> dataset to SVY21 (EPSG: 3414).</p>
</div>
</div>
<p>This gives us the new simple feature data frame, <code>grab_sf</code></p>
</section>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">2.5 Data Wrangling</h2>
<section id="extracting-grab-trips-starting-locations" class="level3">
<h3 class="anchored" data-anchor-id="extracting-grab-trips-starting-locations">2.5.1 <strong>Extracting Grab Trips Starting Locations</strong></h3>
<p>We will extract trip starting point for all unqiue trajectories and store them to a new df named <code>grab_origin</code>. To isolate the origin locations, we use the following methodology:</p>
<ol type="1">
<li><p><strong>Grouping by Trajectory ID:</strong></p>
<ul>
<li>The dataset is grouped by the unique trajectory identifier (<strong><code>trj_id</code></strong>).</li>
</ul></li>
<li><p><strong>Arranging by Timestamp:</strong></p>
<ul>
<li>Within each trajectory group, records are arranged in ascending order based on the timestamp (<strong><code>pingtimestamp</code></strong>).</li>
</ul></li>
<li><p><strong>Filtering for the First Row:</strong></p>
<ul>
<li>By selecting the first row within each grouped trajectory (<strong><code>row_number() == 1</code></strong>), we identify the earliest recorded location for each trip. This is indicative of the trip’s starting point.</li>
</ul></li>
<li><p><strong>Adding Temporal Information:</strong></p>
<ul>
<li><p>Additional temporal context is provided by introducing new columns:</p>
<ul>
<li><p><strong><code>weekday</code></strong>: Day of the week based on the timestamp</p></li>
<li><p><strong><code>start_hr</code></strong>: Starting hour of the trip</p></li>
<li><p><strong><code>day</code></strong>: Day of the month when the trip started</p></li>
</ul></li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>grab_origin <span class="ot">&lt;-</span> grab_sf <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trj_id) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(pingtimestamp) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co">#after sorting by timestamp, first row gives origin location </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">wday</span>(pingtimestamp, <span class="co">#define workday</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">abbr =</span> <span class="cn">TRUE</span>), <span class="co">#Monday = MON </span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">start_hr =</span> <span class="fu">factor</span>(<span class="fu">hour</span>(pingtimestamp)),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">day =</span> <span class="fu">factor</span>(<span class="fu">mday</span>(pingtimestamp))) <span class="co">#to change to ordinal scale</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(grab_origin, "data/rds/grab_origin.rds")</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>grab_origin <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_origin.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>✅ Task Complete! We have retrieved the origin location coordinates for Grab services.</p>
</div>
</div>
</section>
<section id="extracting-grab-trips-ending-locations" class="level3">
<h3 class="anchored" data-anchor-id="extracting-grab-trips-ending-locations">2.5.2 <strong>Extracting Grab Trips Ending Locations</strong></h3>
<p>We will extract trip ending point for all unique trajectories and store them to a new df named <code>grab_dest</code>. We employ a similar methodology to extracting a trips origin location. Except here, within each trajectory group, records are arranged in descending order based on the timestamp (<strong><code>pingtimestamp</code></strong>). By selecting the first row within each grouped trajectory (<strong><code>row_number() == 1</code></strong>), we identify the latest recorded location for each trip. This corresponds to the trip’s ending point.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>grab_dest <span class="ot">&lt;-</span> grab_sf <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trj_id) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pingtimestamp)) <span class="sc">%&gt;%</span> <span class="co">#function from dplyr</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co">#first row after arranging in desc order gives dest  </span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">wday</span>(pingtimestamp, <span class="co">#define workday</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">abbr =</span> <span class="cn">TRUE</span>), <span class="co">#Monday = MON </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">end_hr =</span> <span class="fu">factor</span>(<span class="fu">hour</span>(pingtimestamp)),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">day =</span> <span class="fu">factor</span>(<span class="fu">mday</span>(pingtimestamp))) <span class="co">#to change to ordinal scale</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(grab_dest, "data/rds/grab_dest.rds")</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>grab_dest <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_dest.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>✅ Task Complete! We have retrieved the destination location coordinates for Grab services.</p>
</div>
</div>
</section>
<section id="converting-simple-features-to-planar-point-pattern-objects" class="level3">
<h3 class="anchored" data-anchor-id="converting-simple-features-to-planar-point-pattern-objects">2.5.3 Converting Simple Features to Planar Point Pattern Objects</h3>
<p>To perform spatial point pattern analysis, firstly, we’ll need to convert the simple features objects (grab_orign and grab_dest) into Spatial* classes. For this we use <code>as.ppp</code> from spatstat package. The <code>st_coordinates</code> function extracts the coordiates from our sf objects and <code>st_bbox</code> will extract the minimum and maximum coordinates of the object along each axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>grab_origin_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(grab_origin), <span class="fu">st_bbox</span>(grab_origin))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grab_origin_ppp, <span class="at">main =</span> <span class="st">"Grab Origin Points as PPP Objects"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>grab_dest_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(grab_dest), <span class="fu">st_bbox</span>(grab_dest))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grab_dest_ppp, <span class="at">main =</span> <span class="st">"Grab Destination Points as PPP Objects"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is not neccessary to change <code>sg_sf</code> into a ppp object as it will be converted to <code>owin</code> instead.</p>
</div>
</div>
</section>
<section id="check-for-duplicates-and-handle-data-errors" class="level3">
<h3 class="anchored" data-anchor-id="check-for-duplicates-and-handle-data-errors">2.5.4 Check for Duplicates and Handle Data Errors</h3>
<p>Let’s have a look at the <code>ppp</code> objects we have created to make sure that there is no duplicates or errors in our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(grab_origin_ppp)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(grab_dest_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>grab_origin_ppp</code> and <code>grab_dest_ppp</code> objects have no duplicated points, but just to be sure, we check again using the <code>any(duplicated()</code> function.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(grab_origin_ppp)) </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(grab_dest_ppp)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output is false for both objects so we move on to the next step.</p>
</section>
<section id="introducing-owin" class="level3">
<h3 class="anchored" data-anchor-id="introducing-owin">2.5.5 Introducing OWIN</h3>
<p>When analysing spatial point patterns, we’ll confine our analysis within a certain geographical area - such as the Singapore boundary. In spatstat, an object called <code>owin</code> is specially designed to represent this polygonal region.</p>
</section>
<section id="creating-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="creating-owin-object">2.5.5.1 Creating OWIN Object</h3>
<p>To create a two dimensional observation window using <code>sg_sf</code> coastal boundary we created earlier, we use the <code>as.owin</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sg_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(sg_sf)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sg_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combining-point-events-and-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="combining-point-events-and-owin-object">2.5.5.2 Combining Point Events and OWIN Object</h3>
<p>Now, we’ll extract the relevant point events that are located within Singapore.</p>
</section>
<section id="origin-points-in-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="origin-points-in-owin-object">2.5.5.2.1 Origin Points in OWIN Object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>grab_origin_ppp_sg <span class="ot">&lt;-</span> grab_origin_ppp[sg_owin]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grab_origin_ppp_sg, <span class="at">main =</span> <span class="st">'[OWIN] Grab Origin Points'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="destination-points-in-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="destination-points-in-owin-object">2.5.5.2.1 Destination Points in OWIN Object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>grab_dest_ppp_sg <span class="ot">&lt;-</span> grab_dest_ppp[sg_owin]</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grab_dest_ppp_sg, <span class="at">main =</span> <span class="st">'[OWIN] Grab Destination Points'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">3.0 Exploratory Data Analysis</h2>
<p>To better understand the spatial data, we employ a series of exploratory techniques.</p>
<section id="spatial-relationship-between-origin-and-destination-points" class="level3">
<h3 class="anchored" data-anchor-id="spatial-relationship-between-origin-and-destination-points">3.1 Spatial Relationship between Origin and Destination Points</h3>
<p>The map below shows the geographical distribution of origin and destination points. By overlaying both sets of points, we can observe areas where origin and destination locations overlap. These overlapping areas indicate regions with bidirectional travel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>combined_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> grab_origin, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Origin"</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> grab_dest, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Destination"</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Spatial Relationship Between Origin and Destination Locations"</span>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Location Type"</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Origin"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Destination"</span> <span class="ot">=</span> <span class="st">"red"</span>), </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Location Type"</span>, </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Origin"</span>, <span class="st">"Destination"</span>)) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="spatio-temporal-visualisations" class="level3">
<h3 class="anchored" data-anchor-id="spatio-temporal-visualisations">3.2 Spatio-Temporal Visualisations</h3>
<p>Spatio-temporal visualisations show us a view of how data evolves over both space and time. These visualisations are particularly useful for analysing patterns, trends, and relationships within datasets.</p>
</section>
<section id="frequency-of-trip-by-hour" class="level3">
<h3 class="anchored" data-anchor-id="frequency-of-trip-by-hour">3.2.1 Frequency of Trip by Hour</h3>
<p>Let’s create interactive plots to provide an insightful representation of the distribution of origin/destination locations and emphasise the specific hours that stand out in terms of pickup/drop-off frequency.</p>
</section>
<section id="origin-or-pickup-frequency" class="level3">
<h3 class="anchored" data-anchor-id="origin-or-pickup-frequency">3.2.1.1 Origin or Pickup Frequency</h3>
<p>For creating a bar plot with <code>ggplot</code>, the pickup hours are first converted to numeric values for analysis. TThe x-axis represents the pickup hours, and the y-axis represents the count of origin locations. To highlight the hours with the highest count with a visual indication, we add a red dashed vertical line on the plot. The <strong><code>ggplot</code></strong> object is then converted into an interactive plot using <strong><code>ggplotly</code></strong>, allowing users to hover over bars for detailed information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>grab_origin<span class="sc">$</span>start_hr <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(grab_origin<span class="sc">$</span>start_hr)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>org<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grab_origin, <span class="fu">aes</span>(<span class="at">x =</span> start_hr)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Origin Locations by Pickup Hour"</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Pickup Hour"</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>max_hour <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">table</span>(grab_origin<span class="sc">$</span>start_hr))</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>org <span class="ot">&lt;-</span> org <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> max_hour, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>org <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(org)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>org</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The chart above indicates that most pickups occur at 2-3pm, a potential reason could include:</p>
<blockquote class="blockquote">
<p><strong>After-School Activities</strong>: this time period may coincide with school release times and after-school activities. Parents might be picking up children or transporting them to various activities.</p>
</blockquote>
</section>
<section id="destination-or-drop-off-frequency" class="level3">
<h3 class="anchored" data-anchor-id="destination-or-drop-off-frequency">3.2.1.2 Destination or Drop-off Frequency</h3>
<p>For creating a bar plot with <code>ggplot</code>, the drop-off hours are first converted to numeric values for analysis. TThe x-axis represents the drop-off hours, and the y-axis represents the count of destination locations. To highlight the hours with the highest count with a visual indication, we add a red dashed vertical line on the plot. The <strong><code>ggplot</code></strong> object is then converted into an interactive plot using <strong><code>ggplotly</code></strong>, allowing users to hover over bars for detailed information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>grab_dest<span class="sc">$</span>end_hr <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(grab_dest<span class="sc">$</span>end_hr)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>dest<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grab_dest, <span class="fu">aes</span>(<span class="at">x =</span> end_hr)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Destinatioon Locations by Drop-off Hour"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drop-off Hour"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>max_hour <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">table</span>(grab_dest<span class="sc">$</span>end_hr))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>dest <span class="ot">&lt;-</span> dest <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> max_hour, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>dest <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(dest)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>dest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The chart above indicates that most drop-offs occur at 2pm, a potential reason could include:</p>
<blockquote class="blockquote">
<p><strong>Lunchtime Rush</strong>: 2pm is often around the time people finish their lunch breaks. This could result in increased travel demand as people return to work or resume their activities.</p>
</blockquote>
</section>
<section id="frequency-of-trip-by-day-of-week" class="level3">
<h3 class="anchored" data-anchor-id="frequency-of-trip-by-day-of-week">3.2.2 Frequency of Trip by Day of Week</h3>
<p>Let’s create a bar chart to explore the frequency of origins/destinations across different days and identify any noteworthy patterns.</p>
</section>
<section id="origin-or-pickup-frequency-by-days" class="level3">
<h3 class="anchored" data-anchor-id="origin-or-pickup-frequency-by-days">3.2.2.1 Origin or Pickup Frequency by Days</h3>
<p>The code uses <code>ggplot</code> to create a bar plot, where each bar represents the frequency of pickups on a specific day. This code produces a informative visualisation to explore patterns in pickup frequency throughout the week.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>origin_day <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grab_origin, <span class="fu">aes</span>(<span class="at">x =</span> weekday))  <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#4C78A8"</span>, <span class="at">color =</span> <span class="st">"#4C78A8"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frequency of Pickup by Day of Week"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"Day"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">theme_minimal</span>()</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>origin_day <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(origin_day)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>origin_day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>The distribution of trips across days appears generally uniform, with a subtle increase observed on Wednesdays.</p>
</blockquote>
</section>
<section id="destination-or-drop-off-frequency-by-days" class="level3">
<h3 class="anchored" data-anchor-id="destination-or-drop-off-frequency-by-days">3.2.2.2 Destination or Drop-off Frequency by Days</h3>
<p>The code uses <code>ggplot</code> to create a bar plot, where each bar represents the frequency of drop-offs on a specific day. This code produces a informative visualisation to explore patterns in drop-off frequency throughout the week.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>dest_day <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> grab_dest, <span class="fu">aes</span>(<span class="at">x =</span> weekday))  <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#FF0000"</span>, <span class="at">color =</span> <span class="st">"#FF0000"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frequency of Drop-off by Day of Week"</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"Day"</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">theme_minimal</span>()</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>dest_day <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(dest_day)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>dest_day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>If we plot by destination, we see the same result. This is expected, considering that each trip’s origin corresponds to a destination.</p>
</blockquote>
</section>
</section>
<section id="first-order-spatial-point-patterns-analysis" class="level2">
<h2 class="anchored" data-anchor-id="first-order-spatial-point-patterns-analysis"><strong>4.0 First-Order Spatial Point Patterns Analysis</strong></h2>
<p>First-order spatial point pattern analysis focuses on the distribution of individual points in a given spatial domain. It involves examining the basic characteristics and properties of the point pattern itself, without considering the interactions or relationship between points.</p>
<section id="rescale-grab_original_ppp_sg-and-grab_dest_ppp_sg" class="level3">
<h3 class="anchored" data-anchor-id="rescale-grab_original_ppp_sg-and-grab_dest_ppp_sg"><strong>4.1</strong> Rescale <code>grab_original_ppp_sg</code> and <code>grab_dest_ppp_sg</code></h3>
<p>For further analysis, it is necessary to convert our data to kilometers, and we can achieve this by utilising the <code>rescale</code> function on <code>grab_original_ppp_sg</code> and <code>grab_dest_ppp_sg</code> which are in metres.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># | eval: false</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>grab_origin_ppp_sg_km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(grab_origin_ppp_sg, <span class="dv">1000</span>, <span class="st">'km'</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>grab_dest_ppp_sg_km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(grab_dest_ppp_sg, <span class="dv">1000</span>, <span class="st">'km'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(grab_origin_ppp_sg_km, "data/rds/grab_origin_ppp_sg_km.rds")</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>grab_origin_ppp_sg_km <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_origin_ppp_sg_km.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(grab_dest_ppp_sg_km, "data/rds/grab_dest_ppp_sg_km.rds")</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>grab_dest_ppp_sg_km <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/grab_dest_ppp_sg_km.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="kernel-density-estimation" class="level3">
<h3 class="anchored" data-anchor-id="kernel-density-estimation">4.2 Kernel Density Estimation</h3>
<p>Kernel Density Estimation (KDE) is a technique used in spatial point pattern analysis to estimate the density of events across a continuous space based on a set of observed point locations. It is particularly when we have a set of spatial points and want to visualise the spatial distribution of these points in a smoother and more continuous way.</p>
<p>The are different approaches for selecting the bandwidth or smoothing parameter of the kernel.</p>
<ul>
<li><p>automatic bandwidth method</p></li>
<li><p>fixed bandwidth method</p></li>
</ul>
</section>
<section id="automatic-bandwidth-method" class="level3">
<h3 class="anchored" data-anchor-id="automatic-bandwidth-method">4.2.1 Automatic bandwidth method</h3>
<p>Here the bandwidth is determined automatically by the algorithm based on some optimisation criterion.</p>
<p>There are several spatstat functions that we can use for automatic bandwidth selection.</p>
<p>The <code>density</code>&nbsp;function allows us to compute a kernel density for a given set of point events.</p>
<p>First, we use the <code>bw.diggle()</code> method.</p>
<ul>
<li><a href="https://search.r-project.org/CRAN/refmans/spatstat.explore/html/bw.diggle.html"><code>bw.diggle()</code></a> Cross Validated Bandwidth Selection for Kernel Density</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>kde_grab_origin_sg_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_grab_origin_sg_bw,<span class="at">main =</span> <span class="st">"KDE Automatic Bandwidth for Origin Points"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>kde_grab_dest_sg_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_dest_ppp_sg_km,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>kde_grab_dest_sg_bw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_grab_dest_sg_bw,<span class="at">main =</span> <span class="st">"KDE Automatic Bandwidth for Destination Points"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="other-bandwidth-selection-methods" class="level3">
<h3 class="anchored" data-anchor-id="other-bandwidth-selection-methods">4.2.1.1 Other Bandwidth Selection Methods</h3>
<p>Additionally we can choose from a series of options for ‘kernel’ which is the smoothing parameter that we will explore later. Let’s explore the other methods for automatic bandwidth selection and retrieve sigma value. The sigma value tells us the amount of smoothing applied when estimating the kernel density.</p>
<ul>
<li><a href="https://search.r-project.org/CRAN/refmans/spatstat.explore/html/bw.diggle.html"><code>bw.diggle()</code></a> Cross Validated Bandwidth Selection for Kernel Density</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>bw_diggle <span class="ot">&lt;-</span> <span class="fu">bw.diggle</span>(grab_origin_ppp_sg_km)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>bw_diggle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><a href="https://search.r-project.org/CRAN/refmans/spatstat.explore/html/bw.CvL.adaptive.html"><code>bw.CvL()</code></a> Cronie and Van Lieshout’s Criterion for Bandwidth Selection for Kernel Density</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>bw_CvL <span class="ot">&lt;-</span> <span class="fu">bw.CvL</span>(grab_origin_ppp_sg_km)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>bw_CvL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><a href="https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/bw.scott"><code>bw.scott()</code></a> Scott’s Rule for Bandwidth Selection for Kernel Density</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>bw_scott <span class="ot">&lt;-</span> <span class="fu">bw.scott</span>(grab_origin_ppp_sg_km)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>bw_scott</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><a href="https://search.r-project.org/CRAN/refmans/spatstat.explore/html/bw.pplHeat.html"><code>bw.ppl()</code></a> Likelihood Cross Validation Bandwidth Selection for Kernel Density</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>bw_ppl <span class="ot">&lt;-</span> <span class="fu">bw.ppl</span>(grab_origin_ppp_sg_km)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>bw_ppl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s plot to compare the output of each method, so that we can see the distinct differences in KDE layers .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>kde_diggle <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, bw_diggle)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>kde_CvL <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, bw_CvL)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>kde_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, bw_scott)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>kde_ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, bw_ppl)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_diggle,<span class="at">main =</span> <span class="st">"KDE diggle"</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_CvL,<span class="at">main =</span> <span class="st">"KDE CvL"</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_scott,<span class="at">main =</span> <span class="st">"KDE Scott"</span>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_ppl,<span class="at">main =</span> <span class="st">"KDE ppl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>From first glance, it looks as though <code>KDE Scott</code> shows the best resuts with the clearest peaks.</p>
<p>But in order to pick the most suitable method for our analysis, we need to compare the distribution of KDE values. We can do so simply by visualising the distribution using histograms. Let’s check again <code>KDE Scott</code> shows the most ideal result.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(kde_diggle,<span class="at">main =</span> <span class="st">"KDE diggle"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">50</span>, </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(kde_CvL,<span class="at">main =</span> <span class="st">"KDE CvL"</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">50</span>, </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(kde_scott,<span class="at">main =</span> <span class="st">"KDE Scott"</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">50</span>, </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(kde_ppl,<span class="at">main =</span> <span class="st">"KDE ppl"</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">50</span>, </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="choosing-the-most-appropriate-kde-selection-method" class="level3">
<h3 class="anchored" data-anchor-id="choosing-the-most-appropriate-kde-selection-method">4.2.1.2 Choosing the Most Appropriate KDE Selection Method</h3>
<blockquote class="blockquote">
<p>Looking at the histograms, the one for <code>bw_scott()</code> shows that it has a broad spread as compared to the others and does not peak which means there is an even distribution of points across all bins. Therefore we will pick <code>bw_scott()</code>.</p>
</blockquote>
</section>
<section id="fixed-bandwidth-selection" class="level3">
<h3 class="anchored" data-anchor-id="fixed-bandwidth-selection">4.2.2 Fixed Bandwidth Selection</h3>
<p>Here, we manually specify a fixed bandwidth value for the KDE layer. This allows us to control the level of smoothing applied to the point pattern. We will plot using <code>bw_scott()</code>as identified previously as the most suitable method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fixed_bw_scott <span class="ot">&lt;-</span> <span class="fu">bw.scott</span>(grab_origin_ppp_sg_km)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>fixed_bw_scott</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The values returned are 1.59 and 0.94 for sigma.x and sigma.y respectively.</p>
<p>Then, we plot to visualise the fixed bandwidth using <code>bw_scott</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, fixed_bw_scott)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed_bw_scott, <span class="at">main =</span><span class="st">'Scott Method Fixed Bandwidth KDE for Origin Points'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="different-kernel-function-selection-methods-for-fixed-bandwidth" class="level3">
<h3 class="anchored" data-anchor-id="different-kernel-function-selection-methods-for-fixed-bandwidth">4.2.3 Different Kernel Function Selection Methods for Fixed Bandwidth</h3>
<p>The default kernel in&nbsp;<code>density.ppp()</code>&nbsp;is the&nbsp;<code>gaussian</code>. There are other options such as <code>epanechnikov</code>, <code>quartic</code> and <code>disc</code>.</p>
<p>Let’s explore the different kernel function selection methods.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott_gaussian <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sigma=</span>fixed_bw_scott, </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">edge=</span><span class="cn">TRUE</span>, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott_epanechnikov <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sigma=</span>fixed_bw_scott, </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">edge=</span><span class="cn">TRUE</span>, </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel=</span><span class="st">"epanechnikov"</span>)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott_quartic <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, </span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sigma=</span>fixed_bw_scott, </span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">edge=</span><span class="cn">TRUE</span>, </span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel=</span><span class="st">"quartic"</span>)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>kde_fixed_scott_disc <span class="ot">&lt;-</span> <span class="fu">density</span>(grab_origin_ppp_sg_km, </span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sigma=</span>fixed_bw_scott, </span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">edge=</span><span class="cn">TRUE</span>, </span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel=</span><span class="st">"disc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s visualise the different kernel methods.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed_bw_scott_gaussian, <span class="at">main=</span><span class="st">"Gaussian"</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed_bw_scott_epanechnikov, <span class="at">main=</span><span class="st">"Epanechnikov"</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed_bw_scott_quartic, <span class="at">main=</span><span class="st">"Quartic"</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed_scott_disc,<span class="at">main=</span><span class="st">"Disc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are subtle differences in the smoothness and dispersion among the four plots, but they collectively show the same pattern in the end.</p>
</section>
<section id="kde-layers-with-spatially-adaptive-bandwidth" class="level3">
<h3 class="anchored" data-anchor-id="kde-layers-with-spatially-adaptive-bandwidth">4.2.3 KDE Layers with Spatially Adaptive Bandwidth</h3>
<p>Here, we use the most common adaptive bandwidth method called Adaptive Kernel Density Estimate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>kde_adaptive <span class="ot">&lt;-</span> <span class="fu">adaptive.density</span>(grab_origin_ppp_sg_km, <span class="at">method=</span><span class="st">"kernel"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comparing-fixed-and-adaptive-bandwidth" class="level3">
<h3 class="anchored" data-anchor-id="comparing-fixed-and-adaptive-bandwidth">4.2.4 Comparing Fixed and Adaptive Bandwidth</h3>
<p>Let’s do a side-by-side comparision of fixed bandwidth and adaptive bandwidth method .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed_bw_scott_gaussian, <span class="at">main =</span> <span class="st">"Fixed bandwidth"</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_adaptive, <span class="at">main =</span> <span class="st">"Adaptive bandwidth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>The fixed bandwidth method makes it easier to identify areas of higher origin point clusters</p>
</blockquote>
</section>
<section id="interactive-kde-maps" class="level3">
<h3 class="anchored" data-anchor-id="interactive-kde-maps">4.2.5 Interactive KDE Maps</h3>
<p>Now let’s plot interactive KDE maps to have a closer look.</p>
</section>
<section id="converting-kde-output-into-grid-object-into-rasterlayer-object" class="level3">
<h3 class="anchored" data-anchor-id="converting-kde-output-into-grid-object-into-rasterlayer-object">4.2.5.1 Converting KDE Output into Grid Object into RasterLayer Object</h3>
<p>We need to convert our KDE output into grid objects for mapping purposes, here we use the <code>raster()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(kde_fixed_bw_scott)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>kde_adaptive_kernel_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(kde_adaptive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we perform project transformation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_fixed_bw_scott_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:3414 +units=km"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_adaptive_kernel_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:3414 +units=km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="kernel-density-maps-on-openstreetmap" class="level3">
<h3 class="anchored" data-anchor-id="kernel-density-maps-on-openstreetmap">4.2.5.2 Kernel Density Maps on OpenStreetMap</h3>
<p>Finally, we can visualise our Kernel Density Maps on OpenStreetMap</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>kde_fixed_bw_scott_map <span class="ot">&lt;-</span> <span class="fu">tm_basemap</span>(<span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(kde_fixed_bw_scott_raster) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">alpha =</span> <span class="fl">0.65</span>, <span class="at">title =</span> <span class="st">"KDE_Fixed_Scott"</span>, <span class="at">palette =</span> <span class="fu">brewer.pal</span>(<span class="dv">12</span>, <span class="st">"Set3"</span>)) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(mpsz_sf)<span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha=</span><span class="fl">0.1</span>, <span class="at">id=</span><span class="st">"PLN_AREA_N"</span>)<span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Scott Method Fixed Bandwidth KDE for Origin Points"</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_leaflet</span>(kde_fixed_bw_scott_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>kde_adaptive_kernel_map <span class="ot">&lt;-</span> <span class="fu">tm_basemap</span>(<span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(kde_adaptive_kernel_raster) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">alpha =</span> <span class="fl">0.65</span>, <span class="at">title =</span> <span class="st">"KDE_Adaptive_Kernel"</span>, <span class="at">palette =</span> <span class="fu">brewer.pal</span>(<span class="dv">12</span>, <span class="st">"Set3"</span>)) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(mpsz_sf)<span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha=</span><span class="fl">0.1</span>, <span class="at">id=</span><span class="st">"PLN_AREA_N"</span>)<span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Adaptive Bandwidth KDE for Origin Points"</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_leaflet</span>(kde_adaptive_kernel_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="kernel-density-map-analysis" class="level3">
<h3 class="anchored" data-anchor-id="kernel-density-map-analysis">4.2.6 Kernel Density Map Analysis</h3>
<p>Let’s begin by extracting insights from the fixed bandwidth map, where it’s notably easier to identify the high-density pickup areas represented by yellow clusters. A prominent cluster emerges in the central-south region, encompassing stations such as Newton, Orchard, Downtown East, and Rochor. These areas exhibit increased demand for Grab pickups, potentially influenced by their status as tourist attractions. The tendency for individuals to explore these locales and then opt for Grab as their origin point prompts questions about the efficacy of public transport planning in encouraging more sustainable transportation choices.</p>
<p>Additionally, a big cluster forms at Changi Airport, which is quite understandable. Travelers landing in Singapore, often fatigued and burdened with luggage, may prefer the convenience of Grab over public transportation for their journey home.</p>
<p>Beyond these, smaller yet discernible clusters show up in various residential zones. Referencing the adaptive bandwidth map for precise locations, we observe clusters in the north (Choa Chu Kang, Bukit Panjang), west (Jurong West, Jurong East), east (Tampines, Pasir Ris), and north-east (Woodlands, Sembawang, Yishun). This prompts further inquiries into the connectivity of these regions to public transport networks and the factors influencing residents to choose Grab over alternative transportation modes.</p>
<p>In essence, these spatial patterns raise intriguing questions about the accessibility and appeal of public transportation in these specific areas.</p>
</section>
<section id="extract-planning-areas" class="level3">
<h3 class="anchored" data-anchor-id="extract-planning-areas">4.2.7 Extract Planning Areas</h3>
<p>From the array of residential clusters pinpointed in the previous section, we will focus on four specific stations, each corresponding to distinct geographical regions: north, east, west, and north-east.</p>
<ul>
<li><p>North: Choa Chu Kang</p></li>
<li><p>West: Jurong East</p></li>
<li><p>East: Tampines</p></li>
<li><p>North-East: Woodlands</p></li>
</ul>
<p>Let’s extract out these study areas from <code>mpsz_sf</code> using <code>filter</code> and store it in new objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>je <span class="ot">=</span> mpsz_sf<span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PLN_AREA_N <span class="sc">==</span> <span class="st">"JURONG EAST"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>tm <span class="ot">=</span> mpsz_sf<span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PLN_AREA_N <span class="sc">==</span> <span class="st">"TAMPINES"</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>ck <span class="ot">=</span> mpsz_sf<span class="sc">%&gt;%</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PLN_AREA_N <span class="sc">==</span> <span class="st">"CHOA CHU KANG"</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">=</span> mpsz_sf<span class="sc">%&gt;%</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PLN_AREA_N <span class="sc">==</span> <span class="st">"WOODLANDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-target-planning-areas" class="level3">
<h3 class="anchored" data-anchor-id="plotting-target-planning-areas">4.2.7.1 Plotting Target Planning Areas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(je), <span class="at">main =</span> <span class="st">"Jurong East"</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(tm), <span class="at">main =</span> <span class="st">"Tampines"</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(ck), <span class="at">main =</span> <span class="st">"Choa Chu Kang"</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(wd), <span class="at">main =</span> <span class="st">"Woodlands"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we will create <code>owin</code> objects to represent the observation windows for respective planning area.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>je_owin <span class="ot">=</span> <span class="fu">as.owin</span>(je)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>tm_owin <span class="ot">=</span> <span class="fu">as.owin</span>(tm)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>ck_owin <span class="ot">=</span> <span class="fu">as.owin</span>(ck)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>wd_owin <span class="ot">=</span> <span class="fu">as.owin</span>(wd)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>origin_je_ppp <span class="ot">=</span> grab_origin_ppp_sg[je_owin]</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>origin_tm_ppp <span class="ot">=</span> grab_origin_ppp_sg[tm_owin]</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>origin_ck_ppp <span class="ot">=</span> grab_origin_ppp_sg[ck_owin]</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>origin_wd_ppp <span class="ot">=</span> grab_origin_ppp_sg[wd_owin]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="kde-fixed-bandwidth-for-target-planning-areas" class="level4">
<h4 class="anchored" data-anchor-id="kde-fixed-bandwidth-for-target-planning-areas"><strong>4.2.7.2 KDE Fixed-Bandwidth for Target Planning Areas</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>je_kde_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(origin_je_ppp, <span class="at">sigma=</span>bw.scott, <span class="at">main=</span><span class="st">"Jurong East"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>tm_kde_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(origin_tm_ppp, <span class="at">sigma=</span>bw.scott, <span class="at">main=</span><span class="st">"Tampines"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>ck_kde_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(origin_ck_ppp, <span class="at">sigma=</span>bw.scott, <span class="at">main=</span><span class="st">"Choa Chu Kang"</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>wd_kde_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(origin_wd_ppp, <span class="at">sigma=</span>bw.scott, <span class="at">main=</span><span class="st">"Woodlands"</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(je_kde_scott,<span class="at">main =</span> <span class="st">"KDE Jurong East"</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tm_kde_scott,<span class="at">main =</span> <span class="st">"KDE Tampines"</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ck_kde_scott,<span class="at">main =</span> <span class="st">"KDE Choa Chu Kang"</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wd_kde_scott,<span class="at">main =</span> <span class="st">"KDE Woodlands"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, identifying clusters within each planning area is easily achievable. However, pinpointing the exact locations of these clusters requires the incorporation of road networks for each planning area. To achieve this precision, we will leverage a more advanced KDE technique known as Network Kernel Density Estimation (NKDE) in the upcoming sections. This approach will provide deeper insights into the specific roads or areas within each planning area that host these clusters.</p>
</section>
</section>
<section id="nearest-neighbour-analysis" class="level3">
<h3 class="anchored" data-anchor-id="nearest-neighbour-analysis">4.2.8 Nearest Neighbour Analysis</h3>
<p>Nearest Neighbor Analysis helps assess whether the observed spatial pattern is clustered, dispersed, or random.</p>
<p>Here we will be using the Clark-Evans Test of Aggregation.</p>
</section>
<section id="clark-evans-test-of-aggregation" class="level3">
<h3 class="anchored" data-anchor-id="clark-evans-test-of-aggregation">4.2.8.1 Clark-Evans Test of Aggregation</h3>
<p>Here, we will perform the Clark-Evans test of aggregation for a spatial point pattern by using&nbsp;<a href="https://www.rdocumentation.org/packages/spatstat/versions/1.63-3/topics/clarkevans.test"><em>clarkevans.test()</em></a>&nbsp;of&nbsp;<strong>statspat</strong>.</p>
</section>
<section id="origin-points-in-jurong-east" class="level3">
<h3 class="anchored" data-anchor-id="origin-points-in-jurong-east">4.2.8.1.1 Origin Points in Jurong East</h3>
<p>The test hypotheses are:</p>
<ul>
<li><p>H<sub>0</sub> = The distribution of origin points in Jurong East are randomly distributed</p></li>
<li><p>H<sub>1</sub>= The distribution of origin points in Jurong East are not randomly distributed</p></li>
</ul>
<p>The 95% confident interval will be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(origin_je_ppp,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="st">"sg_owin"</span>,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>),</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can conclude that the distribution of origin points in Jurong East is <strong>not randomly distributed</strong></p>
</section>
<section id="origin-points-in-tampines" class="level3">
<h3 class="anchored" data-anchor-id="origin-points-in-tampines">4.2.8.1.2 Origin Points in Tampines</h3>
<p>The test hypotheses are:</p>
<ul>
<li><p>H<sub>0</sub> = The distribution of origin points in Tampines are randomly distributed</p></li>
<li><p>H<sub>1</sub>= The distribution of origin points in Tampines are not randomly distributed</p></li>
</ul>
<p>The 95% confidence interval will be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(origin_tm_ppp,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="st">"sg_owin"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>),</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can conclude that the distribution of origin points in Tampines is <strong>not randomly distributed</strong></p>
</section>
<section id="origin-points-in-choa-chu-kang" class="level3">
<h3 class="anchored" data-anchor-id="origin-points-in-choa-chu-kang">4.2.8.1.3 Origin Points in Choa Chu Kang</h3>
<p>The test hypotheses are:</p>
<ul>
<li><p>H<sub>0</sub> = The distribution of origin points in Choa Chu Kang are randomly distributed</p></li>
<li><p>H<sub>1</sub>= The distribution of origin points in Choa Chu Kang are not randomly distributed</p></li>
</ul>
<p>The 95% confidence interval will be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(origin_ck_ppp,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="st">"sg_owin"</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>),</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can conclude that the distribution of origin points in Choa Chu Kang is <strong>not randomly distributed</strong></p>
</section>
<section id="origin-points-in-woodlands" class="level3">
<h3 class="anchored" data-anchor-id="origin-points-in-woodlands">4.2.8.1.4 Origin Points in Woodlands</h3>
<p>The test hypotheses are:</p>
<ul>
<li><p>H<sub>0</sub> = The distribution of origin points in Woodlands are randomly distributed</p></li>
<li><p>H<sub>1</sub>= The distribution of origin points in Woodlands are not randomly distributed</p></li>
</ul>
<p>The 95% confidence interval will be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(origin_wd_ppp,</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="st">"sg_owin"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>),</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can conclude that the distribution of origin points in Woodlands is <strong>not randomly distributed</strong></p>
</section>
</section>
<section id="network-constrained-kernel-density-estimation-nkde" class="level2">
<h2 class="anchored" data-anchor-id="network-constrained-kernel-density-estimation-nkde"><strong>5.0 Network Constrained Kernel Density Estimation (NKDE)</strong></h2>
<p>Network Kernel Density Estimation (NKDE) is an advanced technique that builds upon the traditional KDE method.</p>
<p>We employ NKDE because the distribution of origin points in our planning areas is not randomly distributed; it is significantly influenced by network structures. NKDE allows us to incorporate this network context, providing a more accurate representation of spatial patterns, particularly along roadways. By considering the connectivity and pathways of the network, NKDE enhances our ability to capture the nuanced distribution of clusters within each planning area, leading to more insightful and precise spatial analysis results</p>
<p>The main difference between the KDE and NKDE is that KDE treats space as a continuous field, and overlooks the underlying network structure, such as roads. NKDE takes into account the network structure, and recognises that spatial relationships may be constrained by the existing road infrastructure. Therefore, NKDE offers better localization of clusters by considering the connectivity and pathways of the network.</p>
<p>Here, we will use <code>spNetwork</code> to create NKDE maps for each of our planning areas and explore what insights we can yield from each.</p>
</section>
<section id="extract-origin-points-and-road-network-of-our-study-areas" class="level2">
<h2 class="anchored" data-anchor-id="extract-origin-points-and-road-network-of-our-study-areas">5.1 Extract origin points and road network of our study areas</h2>
<p>Firstly we need to extract the road networks within each of our study area by using <code>st_intersection</code>. We also use <code>st_union</code> to combine all the geometries of each object into a single geometry.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>je_roads <span class="ot">=</span> <span class="fu">st_intersection</span>(sg_roads,<span class="fu">st_union</span>(je))</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>tm_roads <span class="ot">=</span> <span class="fu">st_intersection</span>(sg_roads,<span class="fu">st_union</span>(tm))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>ck_roads <span class="ot">=</span> <span class="fu">st_intersection</span>(sg_roads,<span class="fu">st_union</span>(ck))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>wd_roads <span class="ot">=</span> <span class="fu">st_intersection</span>(sg_roads,<span class="fu">st_union</span>(wd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After that, we will use <code>st_intersection</code> again to find the origin spots that intersect with our planning areas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>je_origin <span class="ot">=</span> <span class="fu">st_intersection</span>(grab_origin,<span class="fu">st_union</span>(je))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>tm_origin <span class="ot">=</span> <span class="fu">st_intersection</span>(grab_origin,<span class="fu">st_union</span>(tm))</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>ck_origin <span class="ot">=</span> <span class="fu">st_intersection</span>(grab_origin,<span class="fu">st_union</span>(ck))</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>wd_origin <span class="ot">=</span> <span class="fu">st_intersection</span>(grab_origin,<span class="fu">st_union</span>(wd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lixels" class="level2">
<h2 class="anchored" data-anchor-id="lixels">5.2 Lixels</h2>
<p>Each network edge is divided into lixels which represent the lines of the network. To get the lixels of each planning area we use the <code>st_cast</code> function first to convert the geometry types of the features in our object to LINESTRING.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>je_roads <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(je_roads, <span class="st">"LINESTRING"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>tm_roads <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(tm_roads, <span class="st">"LINESTRING"</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>ck_roads <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(ck_roads, <span class="st">"LINESTRING"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>wd_roads <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(wd_roads, <span class="st">"LINESTRING"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After we have converted the geometry type of our planning areas, we use <code>lixelize_lines</code> to create lixels from a set of road lines represented by the planning area objects. The road lines are divided into lixels, each with a length of 750 units. <code>mindist</code> represents the minimum distance between lixels to ensure that resulting lixels are not too close to each other. If the length of the resulting lixel is less than the specified minimum distance, it is combined with the previous lixel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>je_lixels <span class="ot">&lt;-</span> <span class="fu">lixelize_lines</span>(je_roads, </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">750</span>, </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mindist =</span> <span class="dv">375</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>tm_lixels <span class="ot">&lt;-</span> <span class="fu">lixelize_lines</span>(tm_roads, </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">750</span>, </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mindist =</span> <span class="dv">375</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>ck_lixels <span class="ot">&lt;-</span> <span class="fu">lixelize_lines</span>(ck_roads, </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">750</span>, </span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mindist =</span> <span class="dv">375</span>)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>wd_lixels <span class="ot">&lt;-</span> <span class="fu">lixelize_lines</span>(wd_roads, </span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">750</span>, </span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mindist =</span> <span class="dv">375</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="line-center" class="level2">
<h2 class="anchored" data-anchor-id="line-center">5.3 Line Center</h2>
<p>Then we extract the centers of the lixels using <code>lines_center</code>. These serve as the locations for intensity estimation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>je_samples <span class="ot">&lt;-</span> <span class="fu">lines_center</span>(je_lixels)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>tm_samples <span class="ot">&lt;-</span> <span class="fu">lines_center</span>(tm_lixels)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>ck_samples <span class="ot">&lt;-</span> <span class="fu">lines_center</span>(ck_lixels)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>wd_samples <span class="ot">&lt;-</span> <span class="fu">lines_center</span>(wd_lixels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="using-simple-method-to-compute-nkde" class="level2">
<h2 class="anchored" data-anchor-id="using-simple-method-to-compute-nkde">5.4 Using Simple Method to Compute NKDE</h2>
<p>Finally we use the <code>nkde</code> function from <code>spNetwork</code> to get the NKDE. There are several parameters that we can define</p>
<ul>
<li><code>events</code>: the event associated with the analysis</li>
<li><code>w</code>: weight vector, creates a vector of ones with a length equal to the number of rows in the planning area data frame</li>
<li><code>samples</code>: samples used for density estimation</li>
<li><code>kernel_name</code>: type of kernel to be used</li>
<li><code>bw</code>: determines the scale of influence for each point in the density estimation</li>
<li><code>div</code>: the method used to determine the bandwidth</li>
<li><code>method</code>: method used for density estimation</li>
<li><code>digits</code>: number of significant digits displayed in the output</li>
<li><code>tol</code>: tolerance level for convergence in iterative algorithms</li>
<li><code>grid_shape</code>: shape of the grid for calculating the density</li>
<li><code>max_depth</code>: Maximum depth of the tree when building the spatial index</li>
<li><code>agg</code>: number of points aggregated into each grid cell</li>
<li><code>sparse</code>: whether to use sparse matrix representation for efficiency</li>
<li><code>verbose</code>: suppresses verbose output during the process</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>je_density <span class="ot">&lt;-</span> <span class="fu">nkde</span>(je_roads, </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">events =</span> je_origin,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">w =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(je_origin)),</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">samples =</span> je_samples,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">kernel_name =</span> <span class="st">"quartic"</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bw =</span> <span class="dv">300</span>, </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">div=</span> <span class="st">"bw"</span>, </span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"simple"</span>, </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">digits =</span> <span class="dv">1</span>, </span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tol =</span> <span class="dv">1</span>,</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">grid_shape =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_depth =</span> <span class="dv">8</span>,</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">agg =</span> <span class="dv">5</span>,</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>tm_density <span class="ot">&lt;-</span> <span class="fu">nkde</span>(tm_roads, </span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">events =</span> tm_origin,</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">w =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(tm_origin)),</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">samples =</span> tm_samples,</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">kernel_name =</span> <span class="st">"quartic"</span>,</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bw =</span> <span class="dv">300</span>, </span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">div=</span> <span class="st">"bw"</span>, </span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"simple"</span>, </span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">digits =</span> <span class="dv">1</span>, </span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tol =</span> <span class="dv">1</span>,</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">grid_shape =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_depth =</span> <span class="dv">8</span>,</span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">agg =</span> <span class="dv">5</span>,</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>ck_density <span class="ot">&lt;-</span> <span class="fu">nkde</span>(ck_roads, </span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">events =</span> ck_origin,</span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">w =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(ck_origin)),</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>                  <span class="at">samples =</span> ck_samples,</span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">kernel_name =</span> <span class="st">"quartic"</span>,</span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bw =</span> <span class="dv">300</span>, </span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a>                  <span class="at">div=</span> <span class="st">"bw"</span>, </span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"simple"</span>, </span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a>                  <span class="at">digits =</span> <span class="dv">1</span>, </span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tol =</span> <span class="dv">1</span>,</span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a>                  <span class="at">grid_shape =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_depth =</span> <span class="dv">8</span>,</span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a>                  <span class="at">agg =</span> <span class="dv">5</span>,</span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a>wd_density <span class="ot">&lt;-</span> <span class="fu">nkde</span>(wd_roads, </span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a>                  <span class="at">events =</span> wd_origin,</span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true" tabindex="-1"></a>                  <span class="at">w =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(wd_origin)),</span>
<span id="cb73-52"><a href="#cb73-52" aria-hidden="true" tabindex="-1"></a>                  <span class="at">samples =</span> wd_samples,</span>
<span id="cb73-53"><a href="#cb73-53" aria-hidden="true" tabindex="-1"></a>                  <span class="at">kernel_name =</span> <span class="st">"quartic"</span>,</span>
<span id="cb73-54"><a href="#cb73-54" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bw =</span> <span class="dv">300</span>, </span>
<span id="cb73-55"><a href="#cb73-55" aria-hidden="true" tabindex="-1"></a>                  <span class="at">div=</span> <span class="st">"bw"</span>, </span>
<span id="cb73-56"><a href="#cb73-56" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"simple"</span>, </span>
<span id="cb73-57"><a href="#cb73-57" aria-hidden="true" tabindex="-1"></a>                  <span class="at">digits =</span> <span class="dv">1</span>, </span>
<span id="cb73-58"><a href="#cb73-58" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tol =</span> <span class="dv">1</span>,</span>
<span id="cb73-59"><a href="#cb73-59" aria-hidden="true" tabindex="-1"></a>                  <span class="at">grid_shape =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb73-60"><a href="#cb73-60" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_depth =</span> <span class="dv">8</span>,</span>
<span id="cb73-61"><a href="#cb73-61" aria-hidden="true" tabindex="-1"></a>                  <span class="at">agg =</span> <span class="dv">5</span>,</span>
<span id="cb73-62"><a href="#cb73-62" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb73-63"><a href="#cb73-63" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are also required to join the density values into the samples and lixels objects. The obtained densities will be scaled by the total number of origin points and we will multiply by 1000 for km measurement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>je_samples<span class="sc">$</span>density <span class="ot">&lt;-</span> je_density<span class="sc">*</span><span class="fu">nrow</span>(je_origin)<span class="sc">*</span><span class="dv">1000</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>je_lixels<span class="sc">$</span>density <span class="ot">&lt;-</span> je_density<span class="sc">*</span><span class="fu">nrow</span>(je_origin)<span class="sc">*</span><span class="dv">1000</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>tm_samples<span class="sc">$</span>density <span class="ot">&lt;-</span> tm_density<span class="sc">*</span><span class="fu">nrow</span>(tm_origin)<span class="sc">*</span><span class="dv">1000</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>tm_lixels<span class="sc">$</span>density <span class="ot">&lt;-</span> tm_density<span class="sc">*</span><span class="fu">nrow</span>(tm_origin)<span class="sc">*</span><span class="dv">1000</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>ck_samples<span class="sc">$</span>density <span class="ot">&lt;-</span> ck_density<span class="sc">*</span><span class="fu">nrow</span>(ck_origin)<span class="sc">*</span><span class="dv">1000</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>ck_lixels<span class="sc">$</span>density <span class="ot">&lt;-</span> ck_density<span class="sc">*</span><span class="fu">nrow</span>(ck_origin)<span class="sc">*</span><span class="dv">1000</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>wd_samples<span class="sc">$</span>density <span class="ot">&lt;-</span> wd_density<span class="sc">*</span><span class="fu">nrow</span>(wd_origin)<span class="sc">*</span><span class="dv">1000</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>wd_lixels<span class="sc">$</span>density <span class="ot">&lt;-</span> wd_density<span class="sc">*</span><span class="fu">nrow</span>(wd_origin)<span class="sc">*</span><span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-maps-for-different-study-areas" class="level2">
<h2 class="anchored" data-anchor-id="plotting-maps-for-different-study-areas">5.5 Plotting Maps for Different Study Areas</h2>
<p>Let’s plot the NKDE map for each planning area.</p>
<section id="jurong-east" class="level3">
<h3 class="anchored" data-anchor-id="jurong-east">5.5.1 Jurong East</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>je_density_map <span class="ot">&lt;-</span> <span class="fu">tm_basemap</span>(<span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(je_lixels)<span class="sc">+</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span><span class="st">"density"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">palette =</span> <span class="fu">brewer.pal</span>(<span class="dv">12</span>, <span class="st">"Set3"</span>))<span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(je_origin)<span class="sc">+</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.05</span>)<span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Jurong East NKDE"</span>)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_leaflet</span>(je_density_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Analysis</strong></p>
<p>In Jurong East, notable clusters of taxi pick-up points have been observed around Yuhua Place, Yuhua Senior Activity Center, New Jurong Polyclinic, and the nursing home vicinity. Additionally, clusters are prevalent near Parc Oasis, Singtel, Zai Shun Seafood, in proximity to Toh Guan, Westgate, Shen Hong Temple, Jurong East Interchange, IMM, Yuhua Primary School, and Crest Secondary School.</p>
<p>This clustering phenomenon may be attributed to</p>
<ol type="1">
<li><p><strong>Commercial Hubs:</strong> Areas like Westgate and IMM are major commercial centers, attracting a higher demand for Grab services. For example, people may book Grab to pick them up after they finish shopping in these areas.</p></li>
<li><p><strong>Healthcare Facilities:</strong> Proximity to healthcare facilities such as the New Jurong Polyclinic and nursing homes may lead to increased transportation needs. For example, patients or visitors might utilise Grab for convenient travel from medical appointments, contributing to the clustering effect around healthcare establishments.</p></li>
<li><p><strong>Educational Institutions:</strong> The presence of schools like Yuhua Primary School and Crest Secondary School could contribute to higher Grab demand during school-related activities. For example, parents may pick up their children after school and book Grab to their residence.</p></li>
<li><p><strong>Transportation Hubs:</strong> Jurong East Interchange serves as a transportation hub, leading to concentrated Grab activity in the area. Commuters arriving at or departing from the interchange might prefer Grab for last-mile connectivity, resulting in a clustering effect around this transportation hub.</p></li>
<li><p><strong>Recreational Areas:</strong> Clusters around Parc Oasis and Yuhua Senior Activity Center may be influenced by recreational and leisure activities. Caregivers visiting seniors at the Senior Activity Center may book Grab from there to their homes.</p></li>
<li><p><strong>Cultural and Religious Centers:</strong> Locations like Shen Hong Temple may attract Grab pick-ups during events or gatherings. Attendees of cultural or religious events may use Grab for transportation from these centers.</p></li>
<li><p><strong>Residential Areas:</strong> Proximity to residential areas like Yuhua Place may result in frequent Grab pickup requests for residents. Residents in these areas might regularly utilise Grab for daily commuting or transportation needs.</p></li>
<li><p><strong>Culinary Hotspots:</strong> Clusters around Zai Shun Seafood restaurant may be influenced by popular dining establishments, drawing people to the area and making them book Grab from there to their journey back.</p></li>
</ol>
</div>
</div>
</section>
<section id="tampines" class="level3">
<h3 class="anchored" data-anchor-id="tampines">5.5.2 Tampines</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>tm_density_map <span class="ot">&lt;-</span> <span class="fu">tm_basemap</span>(<span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(tm_lixels)<span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span><span class="st">"density"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">palette =</span> <span class="fu">brewer.pal</span>(<span class="dv">12</span>, <span class="st">"Set3"</span>))<span class="sc">+</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(tm_origin)<span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.05</span>)<span class="sc">+</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Tampines NKDE"</span>)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_leaflet</span>(tm_density_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Analysis</strong></p>
<p>In Tampines, clusters of Grab pick-up points are notable around Our Tampines Hub, Tanah Merah Country Club, opposite Tampines Neighbourhood Police Center, opposite Ngee Ann Secondary School, Tampines East, Laguna Country Club, and East Coast Park.</p>
<p>This clustering phenomenon may be attributed to</p>
<p><strong>Recreational Clubs</strong>: Areas like Tanah Merah Country Club and Laguna Country Club may contribute to clusters of Grab pick-up points. Individuals visiting these recreational clubs for leisure activities may opt for Grab services for their journey back from here for convenience.</p>
<p><strong>Police Center</strong>: The area opposite Tampines Neighbourhood Police Center may attract Grab pick-ups due visitors requiring transportation from the area.</p>
<p><strong>Community and Recreational Center</strong>: Our Tampines Hub is a central community and recreational center, leading to higher demand for Grab services. People utilising the various facilities may book Grab for their journeys back.</p>
<p><strong>Educational Institutions</strong>: The area opposite Ngee Ann Secondary School could contribute to higher Grab demand during school-related activities. For example, parents may pick up their children after school and book Grab to their residence.</p>
<p><strong>Residential Areas</strong>: Tampines East, being a residential area, may result in frequent Grab pickup requests for residents. Residents in these areas might regularly utilise Grab for daily commuting or transportation needs.</p>
<p><strong>Recreational Destination</strong>: East Coast Park, a popular recreational area, may attract individuals for outdoor activities. Visitors to the park may choose to book Grab for their journey back home, contributing to the clustering effect.</p>
</div>
</div>
</section>
<section id="choa-chu-kang" class="level3">
<h3 class="anchored" data-anchor-id="choa-chu-kang">5.5.3 Choa Chu Kang</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>ck_density_map <span class="ot">&lt;-</span> <span class="fu">tm_basemap</span>(<span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(ck_lixels)<span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span><span class="st">"density"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">palette =</span> <span class="fu">brewer.pal</span>(<span class="dv">12</span>, <span class="st">"Set3"</span>))<span class="sc">+</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(ck_origin)<span class="sc">+</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.05</span>)<span class="sc">+</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Choa Chu Kang NKDE"</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_leaflet</span>(ck_density_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Analysis</strong></p>
<p>In Choa Chu Kang, clusters of Grab pick-up points can be seen around Inn See Temple, Choa Chu Kang Interchange, SAFRA@CCK, Gain City, Lot One, Keat Hong Colours, Phoenix Station, Bukit Panjang Post Office, Yew Mei Condominium, MWS Nursing Home, and Yew Tee Point.</p>
<p>This clustering phenomenon may be attributed to</p>
<ol type="1">
<li><p><strong>Cultural and Religious Centers:</strong> Inn See Temple’s vicinity may attract Grab pick-ups during religious events, contributing to the observed cluster.</p></li>
<li><p><strong>Transportation Hub:</strong> Choa Chu Kang Interchange serves as a transportation hub, leading to concentrated Grab activity in the area. Commuters arriving at or departing from the interchange might prefer Grab for last-mile connectivity, resulting in a clustering effect around this transportation hub.</p></li>
<li><p><strong>Recreational Facility:</strong> The presence of SAFRA@CCK could contribute to increased Grab pickup activity, especially after events and recreational activities hosted at the facility.</p></li>
<li><p><strong>Shopping Centers:</strong> Yew Tee Point, Gain City and Lot One, being prominent shopping destinations, may experience a higher level of Grab pick-up points as shoppers prefer convenient transportation after their shopping sprees.</p></li>
<li><p><strong>Residential Areas:</strong> Clusters around Keat Hong Colours, and Yew Mei Condominium may be attributed to the residential nature of these areas, with residents relying on Grab for commuting needs.</p></li>
<li><p><strong>Postal Area:</strong> Bukit Panjang Post Office may attract Grab pick-ups, for individuals who have completed their postal services or nearby activities.</p></li>
<li><p><strong>Healthcare:</strong> Presence of MWS Nursing Home may lead to increased transportation needs. Caregivers visiting seniors at the nursing home may book Grab from there to their homes.</p></li>
</ol>
</div>
</div>
</section>
<section id="woodlands" class="level3">
<h3 class="anchored" data-anchor-id="woodlands">5.5.4 Woodlands</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>wd_density_map <span class="ot">&lt;-</span> <span class="fu">tm_basemap</span>(<span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(wd_lixels)<span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span><span class="st">"density"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">palette =</span> <span class="fu">brewer.pal</span>(<span class="dv">12</span>, <span class="st">"Set3"</span>))<span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(wd_origin)<span class="sc">+</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.05</span>)<span class="sc">+</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Woodlands NKDE"</span>)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_leaflet</span>(wd_density_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In Woodlands, distinct clusters of taxi pick-up points have been identified around Innova Junior College, Singapore Sports School, Civic Centre, STELLAR@TE2, Singapore Turf Club, Old Woodlands Town Centre, Masjid An Nur, Woodlands Cinema, Greenwood Primary School, and Mega@Woodlands.</p>
<p>This clustering phenomenon may be attributed to</p>
<ol type="1">
<li><p><strong>Educational Institutions:</strong> Clusters around Innova Junior College and Singapore Sports School could be attributed to the presence of these educational institutions. Students, staff, and visitors may opt for Grab for convenient transportation from these locations.</p></li>
<li><p><strong>Civic and Community Center:</strong> Civic Centre, being a civic and community hub, may experience higher demand for Grab pickup services.</p></li>
<li><p><strong>Commercial Hub:</strong> STELLAR@TE2’s may have individuals possibly relying on Grab for commuting on their journey back from here.</p></li>
<li><p><strong>Sports and Recreation:</strong> The presence of Singapore Turf Club may contribute to the clustering effect, with people choosing Grab for transportation from sports and recreational activities.</p></li>
<li><p><strong>Commercial and Residential Hub:</strong> Old Woodlands Town Centre’s central location may attract Grab pick-ups from both commercial and residential areas.</p></li>
<li><p><strong>Religious Center:</strong> Masjid An Nur’s may witness increased Grab activity during religious events.</p></li>
<li><p><strong>Entertainment Venue:</strong> Woodlands Cinema’s indicates a potential concentration of Grab pick-up points, especially after movie screenings, as patrons opt for Grab for their journey home.</p></li>
<li><p><strong>Educational Facility:</strong> Greenwood Primary School’s location could contribute to higher Grab demand during school-related activities. For example, parents may pick up their children after school and book Grab to their residence.</p></li>
</ol>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">6.0 Conclusion</h2>
<p>Through this take-home exercise, we delved into Spatial Point Patterns Analysis to unravel the geographical distribution of Grab Hailing Services in Singapore. Our analyses provided valuable insights, unveiling patterns such as the peak day and time for Grab pick-ups, the specific locations where these pickups occur, hotspots, and the particular roads that witness heightened activity. This information serves as a strategic tool for better planning and decision-making.</p>
<p>For instance, we can leverage these findings to enhance public transport accessibility. Understanding the road networks with the highest Grab pick-up activity allows us to identify areas where improved public transportation services could be implemented. This strategic planning aims to encourage people to opt for public transport, contributing to even pollution reduction by minimising car usage.</p>
<p>In our future endeavors, we can expand our exploration by delving into temporal Network Kernel Density Estimation (NKDE). This advanced analysis will enable us to scrutinise the intricate relationship between time and Grab Hailing Services. By identifying popular pick-up points during specific time intervals, we can propose strategic interventions, such as increasing the number of buses, adjusting bus frequencies, or implementing targeted measures to enhance transportation infrastructure in those areas. This forward-looking approach ensures a nuanced understanding of temporal patterns and facilitates more informed decisions for optimizing transportation services in Singapore.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">7.0 References</h2>
<ol type="1">
<li><p>Kam, T. S. (2022). R for Geospatial Data Science and Analytics. Retrieved from https://r4gdsa.netlify.app.</p></li>
<li><p>Gimond (2023). Chapter 11 Point Pattern Analysis. Retrieved from https://mgimond.github.io/Spatial/index.html.</p></li>
<li><p>Rey, S.J., Arribas-Bel, D., &amp; Wolf, L.J. (2023). Point Pattern Analysis. In: Geographic Data Science with python. CRC Press.</p></li>
<li><p>Moraga, P. Spatial Statistics for Data Science: Theory and Practice with R. Retrieved from https://www.paulamoraga.com/book-spatial/spatial-point-patterns.html.</p></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>